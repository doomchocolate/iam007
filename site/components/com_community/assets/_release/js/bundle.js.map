{"version":3,"file":"bundle.js","sources":["sandbox.js","views/base.js","app.js","utils/ajax.js","utils/constants.js","views/postbox/default.js","utils/image.js","utils/language.js","views/postbox/fetcher.js","views/inputbox/base.js","views/inputbox/status.js","views/dropdown/base.js","views/dropdown/mood.js","views/dropdown/location.js","views/dropdown/privacy.js","views/postbox/status.js","views/widget/select.js","views/widget/select-album.js","views/postbox/photo-preview.js","views/inputbox/photo.js","utils/uploader.js","views/postbox/photo.js","views/inputbox/videourl.js","views/postbox/fetcher-video.js","views/inputbox/video.js","views/postbox/video.js","views/inputbox/eventtitle.js","views/inputbox/eventdesc.js","utils/format.js","views/dropdown/event.js","views/postbox/event.js","views/postbox/custom.js","views/postbox/layout.js","views/stream/filterbar.js","views/stream/item.js","views/stream/layout.js","views/header/layout.js","init.js","bundle.js"],"names":[],"mappings":"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","sourcesContent":["\n// -----------------------------------------------------------------------------\n// sandbox\n// -----------------------------------------------------------------------------\n\ndefine('sandbox',[],function() {\n\tvar jqr = window.joms.jQuery,\n\t\tund = window._,\n\t\tbbe = window.Backbone;\n\n\t// Sandbox object, also serves as a DOM selector.\n\tfunction Sandbox( selector, context ) {\n\t\treturn jqr( selector, context );\n\t}\n\n\t// Set Backbone to use default jQuery.\n\tbbe.$ = jqr;\n\n\t// Filter used Underscore functions.\n\tund.pick( und, [\n\t\t'each',\n\t\t'filter',\n\t\t'intersection',\n\t\t'without',\n\t\t'bind',\n\t\t'debounce',\n\t\t'defer',\n\t\t'keys',\n\t\t'extend',\n\t\t'pick',\n\t\t'omit',\n\t\t'isArray',\n\t\t'isNumber',\n\t\t'isString',\n\t\t'isUndefined',\n\t\t'uniqueId'\n\t]);\n\n\t// Extend sandbox with events, selected Underscore functions,\n\t// Backbone MVC, and some.\n\tund.extend( Sandbox, bbe.Events, und, {\n\n\t\t// MV*\n\t\tmvc: {\n\t\t\tModel: bbe.Model,\n\t\t\tModels: bbe.Collection,\n\t\t\tView: bbe.View\n\t\t},\n\n\t\t// Ajax helper.\n\t\tajax: jqr.ajax,\n\t\tparam: jqr.param,\n\n\t\t// NOOP\n\t\tnoop: function() {}\n\n\t});\n\n\t// Enable deep-extend via jQuery extend.\n\tSandbox.__extend = Sandbox.extend;\n\tSandbox._$extend = jqr.extend;\n\tSandbox.extend = function() {\n\t\tvar isDeep = arguments[0] === true;\n\t\treturn Sandbox[ isDeep ? '_$extend' : '__extend' ].apply( null, arguments );\n\t};\n\n\t// Browser detection.\n\tSandbox.ua = navigator.userAgent;\n\n\tvar ua = Sandbox.ua.toLowerCase();\n\tSandbox.mobile    = !!ua.match( /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i );\n\tSandbox.webkit    = !!ua.match( /webkit/i );\n\tSandbox.ie        = !!ua.match( /msie/i );\n\tSandbox.ieVersion = Sandbox.ie && +( ua.match( /msie (\\d+)\\./i )[1] );\n\n\t// Experimental flag.\n\tSandbox.xpriment = !Sandbox.ie && 1;\n\n\t// Publish onclick event.\n\tSandbox( document.body ).on( 'click', function( e ) {\n\t\tSandbox.trigger( 'click', Sandbox( e.target ) );\n\t});\n\n\treturn Sandbox;\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/base\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/base',[\n\t'sandbox'\n],\n\n// definition\n// ----------\nfunction( $ ) {\n\n\treturn $.mvc.View.extend({\n\n\t\tassign: function( element, view ) {\n\t\t\tif ( !$.isArray( element ) ) {\n\t\t\t\telement = [ [ element, view ] ];\n\t\t\t}\n\n\t\t\t$.each( element, function( item ) {\n\t\t\t\titem[ 1 ].setElement( item[ 0 ] ).render();\n\t\t\t});\n\t\t},\n\n\t\tshow: function() {\n\t\t\tif ( this.isHidden() ) {\n\t\t\t\tthis.$el.show();\n\t\t\t\tthis.trigger('show');\n\t\t\t}\n\t\t},\n\n\t\thide: function() {\n\t\t\tif ( !this.isHidden() ) {\n\t\t\t\tthis.$el.hide();\n\t\t\t\tthis.trigger('hide');\n\t\t\t}\n\t\t},\n\n\t\ttoggle: function() {\n\t\t\tthis.isHidden() ? this.show() : this.hide();\n\t\t},\n\n\t\tisHidden: function() {\n\t\t\treturn this.el.style.display === 'none';\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// app\n// -----------------------------------------------------------------------------\n\n// definition\n// ----------\ndefine('app',[],function() {\n\tvar staticUrl;\n\n\tstaticUrl = require.toUrl('');\n\tstaticUrl = staticUrl.replace( /js\\/$/, '' );\n\tstaticUrl = staticUrl.replace( /\\?.+$/, '' );\n\n\treturn {\n\t\tbaseUrl: '',\n\t\tstaticUrl: staticUrl,\n\t\tlegacyUrl: staticUrl + '../../'\n\t};\n\n});\n","\n// -----------------------------------------------------------------------------\n// utils/ajax\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('utils/ajax',[\n\t'sandbox'\n],\n\n// definition\n// ----------\nfunction( $ ) {\n\n\tvar defaults = {\n\t\ttype: 'post',\n\t\tdata: {},\n\t\tdataType: 'json',\n\t\terror: $.noop,\n\t\tsuccess: $.noop,\n\t\tcomplete: $.noop\n\t};\n\n\tfunction ajax( options ) {\n\t\toptions = $.extend({}, defaults, options || {});\n\t\toptions.url = window.jax_live_site;\n\t\toptions.data = encodeData( options.fn, options.data );\n\t\treturn $.ajax( options );\n\t}\n\n\t// encode request data\n\tfunction encodeData( fn, data ) {\n\t\tvar params = {};\n\n\t\t// azrul's ajax parameters\n\t\tparams.option = 'community';\n\t\tparams.no_html = 1;\n\t\tparams.task = 'azrul_ajax';\n\t\tparams.func = fn;\n\t\tparams[ window.jax_token_var ] = 1;\n\n\t\t// azrul's data format\n\t\t$.isArray( data ) || (data = []);\n\t\tfor ( var i = 0, arg; i < data.length; i++ ) {\n\t\t\targ = data[ i ];\n\t\t\t$.isString( arg ) && ( arg = arg.replace( /\"/g, '&quot;' ) );\n\t\t\t$.isArray( arg ) || ( arg = [ '_d_', arg ] );\n\t\t\tparams[ 'arg' + ( i + 2 ) ] = JSON.stringify( arg );\n\t\t}\n\n\t\treturn params;\n\t}\n\n\treturn ajax;\n\n});\n","\n// -----------------------------------------------------------------------------\n// utils/constants\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('utils/constants',[\n\t'sandbox'\n],\n\n// definition\n// ----------\nfunction( $ ) {\n\n\tvar constants = {};\n\n\tfunction get( key ) {\n\t\tif ( typeof key !== 'string' || !key.length )\n\t\t\treturn;\n\n\t\tif ( joms && joms.constants ) {\n\t\t\t$.extend( true, constants, joms && joms.constants );\n\t\t\tdelete joms.constants;\n\t\t}\n\n\t\tvar data = constants;\n\n\t\tkey = key.split('.');\n\t\twhile ( key.length ) {\n\t\t\tdata = data[ key.shift() ];\n\t\t}\n\n\t\treturn data;\n\t}\n\n\treturn {\n\t\tget: get\n\t};\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/postbox/default\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/postbox/default',[\n\t'sandbox',\n\t'app',\n\t'views/base',\n\t'utils/ajax',\n\t'utils/constants'\n],\n\n// definition\n// ----------\nfunction( $, App, BaseView, ajax, constants ) {\n\n\treturn BaseView.extend({\n\n\t\tsubviews: {},\n\n\t\t// @abstract\n\t\ttemplate: function() {\n\t\t\tthrow new Error('Method not implemented.');\n\t\t},\n\n\t\tevents: {\n\t\t\t'click li[data-tab]': 'onToggleDropdown',\n\t\t\t'click button.joms-postbox-cancel': 'onCancel',\n\t\t\t'click button.joms-postbox-save': 'onPost'\n\t\t},\n\n\t\tinitialize: function( options ) {\n\t\t\tif ( options && options.single )\n\t\t\t\tthis.single = true;\n\n\t\t\tthis.subflags = {};\n\t\t\tthis.reset();\n\t\t},\n\n\t\trender: function() {\n\t\t\tvar div = this.getTemplate();\n\t\t\tthis.$el.replaceWith( div );\n\t\t\tthis.setElement( div );\n\n\t\t\tthis.$tabs = this.$('.joms-postbox-tab');\n\t\t\tthis.$action = this.$('.joms-postbox-action').hide();\n\t\t\tthis.$loading = this.$('.joms-postbox-loading').hide();\n\t\t\tthis.$save = this.$('.joms-postbox-save').hide();\n\n\t\t\treturn this;\n\t\t},\n\n\t\tshow: function() {\n\t\t\tthis.showInitialState();\n\t\t\tBaseView.prototype.show.apply( this );\n\t\t},\n\n\t\tshowInitialState: function() {\n\t\t\tthis.reset();\n\t\t\tthis.$tabs.hide();\n\t\t\tthis.$action.hide();\n\t\t\tthis.$save.hide();\n\t\t\tthis.trigger('show:initial');\n\t\t},\n\n\t\tshowMainState: function() {\n\t\t\tthis.$tabs.show();\n\t\t\tthis.$action.show();\n\t\t\tthis.trigger('show:main');\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Data validation and retrieval.\n\t\t// ---------------------------------------------------------------------\n\n\t\treset: function() {\n\t\t\tthis.data = {};\n\t\t\tthis.data.text = '';\n\t\t\tthis.data.attachment = {};\n\t\t\tfor ( var prop in this.subflags ) {\n\t\t\t\tthis.subviews[ prop ].reset();\n\t\t\t\tthis.subviews[ prop ].hide();\n\t\t\t}\n\t\t},\n\n\t\tvalue: function( noEncode ) {\n\t\t\tvar attachment = $.extend({}, this.getStaticAttachment(), this.data.attachment );\n\n\t\t\t// DEBUGGING PURPOSE\n\t\t\t// if ( !noEncode ) {\n\t\t\t// \tconsole.log( this.data.text );\n\t\t\t// \tconsole.log( attachment );\n\t\t\t// }\n\n\t\t\treturn [\n\t\t\t\tthis.data.text,\n\t\t\t\tnoEncode ? attachment : JSON.stringify( attachment )\n\t\t\t];\n\t\t},\n\n\t\t// Data validation method, truthy return value will raise error.\n\t\t// Go to `this.onPost` to see how this method is used.\n\t\tvalidate: $.noop,\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonToggleDropdown: function( e ) {\n\t\t\tvar elem = $( e.currentTarget );\n\t\t\tif ( elem.data('bypass') )\n\t\t\t\treturn;\n\n\t\t\tvar type = elem.data('tab');\n\t\t\tif ( !this.subviews[ type ] )\n\t\t\t\treturn;\n\n\t\t\tif ( !this.subflags[ type ] )\n\t\t\t\tthis.initSubview( type );\n\n\t\t\tif ( !this.subviews[ type ].isHidden() ) {\n\t\t\t\tthis.subviews[ type ].hide();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor ( var prop in this.subflags )\n\t\t\t\tif ( prop !== type )\n\t\t\t\t\tthis.subviews[ prop ].hide();\n\n\t\t\tthis.subviews[ type ].show();\n\t\t},\n\n\t\tonCancel: function() {\n\t\t\tif ( App.postbox && App.postbox.value )\n\t\t\t\tApp.postbox.value = false;\n\n\t\t\tif ( !this.saving )\n\t\t\t\tthis.showInitialState();\n\t\t},\n\n\t\tonPost: function() {\n\t\t\tif ( this.saving )\n\t\t\t\treturn;\n\n\t\t\tvar error = this.validate();\n\t\t\tif ( error ) {\n\t\t\t\twindow.alert( error );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.saving = true;\n\t\t\tthis.$loading.show();\n\n\t\t\tvar that = this;\n\t\t\tajax({\n\t\t\t\tfn: 'system,ajaxStreamAdd',\n\t\t\t\tdata: this.value(),\n\t\t\t\tsuccess: $.bind( this.onPostSuccess, this ),\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tthat.$loading.hide();\n\t\t\t\t\tthat.saving = false;\n\t\t\t\t\tthat.showInitialState();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tonPostSuccess: function( response ) {\n\t\t\tvar html = this.parseResponse( response ),\n\t\t\t\tstream;\n\n\t\t\tif ( html ) {\n\t\t\t\tstream = $('#activity-stream-container');\n\t\t\t\tstream.html( html );\n\n\t\t\t\t// reset filter to default\n\t\t\t\tvar filter = $('.joms-activity-filter-action .joms-activity-filter-status');\n\t\t\t\tif ( filter && filter.length )\n\t\t\t\t\tfilter.html( filter.data('default') );\n\t\t\t}\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Lazy subview initialization.\n\t\t// ---------------------------------------------------------------------\n\n\t\tinitSubview: function( type, options ) {\n\t\t\tvar Type = type.replace( /^./, function( chr ){ return chr.toUpperCase(); });\n\t\t\tif ( !this.subflags[ type ] ) {\n\t\t\t\tthis.subviews[ type ] = new this.subviews[ type ]( options );\n\t\t\t\tthis.assign( this.getSubviewElement(), this.subviews[ type ] );\n\t\t\t\tthis.listenTo( this.subviews[ type ], 'init', this[ 'on' + Type + 'Init' ] );\n\t\t\t\tthis.listenTo( this.subviews[ type ], 'show', this[ 'on' + Type + 'Show' ] );\n\t\t\t\tthis.listenTo( this.subviews[ type ], 'hide', this[ 'on' + Type + 'Hide' ] );\n\t\t\t\tthis.listenTo( this.subviews[ type ], 'select', this[ 'on' + Type + 'Select' ] );\n\t\t\t\tthis.listenTo( this.subviews[ type ], 'remove', this[ 'on' + Type + 'Remove' ] );\n\t\t\t\tthis.subflags[ type ] = true;\n\t\t\t}\n\t\t},\n\n\t\tgetSubviewElement: function() {\n\t\t\tvar div = $('<div>').hide().appendTo( this.$el );\n\t\t\treturn div;\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Ajax response parser.\n\t\t// ---------------------------------------------------------------------\n\n\t\tparseResponse: function( response ) {\n\t\t\tvar elid = 'activity-stream-container',\n\t\t\t\tdata;\n\n\t\t\tif ( response && response.length ) {\n\t\t\t\tfor ( var i = 0; i < response.length; i++ )\t{\n\t\t\t\t\tif ( response[i][1] === elid ) {\n\t\t\t\t\t\tdata = response[i][3];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn data;\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Helper functions.\n\t\t// ---------------------------------------------------------------------\n\n\t\tgetTemplate: function() {\n\t\t\tvar html = this.template({ juri: constants.get('juri') });\n\t\t\treturn $( html ).hide();\n\t\t},\n\n\t\tgetStaticAttachment: function() {\n\t\t\tif ( this.staticAttachment )\n\t\t\t\treturn this.staticAttachment;\n\n\t\t\tthis.staticAttachment = $.extend({},\n\t\t\t\tconstants.get('postbox.attachment') || {},\n\t\t\t\t{ type: '' }\n\t\t\t);\n\n\t\t\treturn this.staticAttachment;\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// utils/image\n// -----------------------------------------------------------------------------\n\n// definition\n// ----------\ndefine('utils/image',[],function() {\n\n\tfunction Preloader( images, callback ) {\n\t\tthis.images = [];\n\t\tthis.loaded = [];\n\t\tthis.processed = 0;\n\t\tthis.callback = callback;\n\n\t\tif ( !images || !images.length ) {\n\t\t\timages = [];\n\t\t}\n\n\t\t// sanitize url\n\t\tvar rUrl = /^(http:|https:)?\\/\\/([a-z0-9-]+\\.)+[a-z]{2,4}\\/.*$/i;\n\t\tfor ( var i = 0; i < images.length; i++ ) {\n\t\t\tif ( images[i].match( rUrl ) )\n\t\t\t\tthis.images.push( images[i] );\n\t\t}\n\n\t}\n\n\tPreloader.prototype.load = function() {\n\t\tif ( !this.images || !this.images.length ) {\n\t\t\tthis.callback([]);\n\t\t\treturn;\n\t\t}\n\n\t\tfor ( var i = 0, img; i < this.images.length; i++ ) {\n\t\t\timg = new Image();\n\t\t\timg.onload = this.onload;\n\t\t\timg.onerror = this.onerror;\n\t\t\timg.onabort = this.onabort;\n\t\t\timg.preloader = this;\n\t\t\timg.src = this.images[i];\n\t\t}\n\t};\n\n\tPreloader.prototype.onload = function() {\n\t\tthis.preloader.loaded.push( this.src );\n\t\tthis.preloader.oncomplete();\n\t};\n\n\tPreloader.prototype.onerror = function() {\n\t\tthis.preloader.oncomplete();\n\t};\n\n\tPreloader.prototype.onabort = function() {\n\t\tthis.preloader.oncomplete();\n\t};\n\n\tPreloader.prototype.oncomplete = function() {\n\t\tvar i, images = [];\n\n\t\tthis.processed++;\n\t\tif ( this.processed >= this.images.length ) {\n\t\t\tfor ( i = 0; i < this.images.length; i++ )\n\t\t\t\tif ( this.loaded.indexOf( this.images[ i ] ) > -1 )\n\t\t\t\t\timages.push( this.images[ i ] );\n\n\t\t\tthis.callback( images );\n\t\t}\n\t};\n\n\tfunction preload( images, callback ) {\n\t\tvar pre = new Preloader( images, callback );\n\t\tpre.load();\n\t}\n\n\treturn {\n\t\tpreload: preload\n\t};\n\n});\n","\n// -----------------------------------------------------------------------------\n// utils/language\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('utils/language',[\n\t'sandbox'\n],\n\n// definition\n// ----------\nfunction( $ ) {\n\n\tvar language = {};\n\n\tfunction get( key ) {\n\t\tif ( typeof key !== 'string' || !key.length )\n\t\t\treturn;\n\n\t\tif ( joms && joms.language ) {\n\t\t\t$.extend( true, language, joms && joms.language );\n\t\t\tdelete joms.language;\n\t\t}\n\n\t\tvar data = language;\n\n\t\tkey = key.split('.');\n\t\twhile ( key.length ) {\n\t\t\tdata = data[ key.shift() ];\n\t\t}\n\n\t\treturn data;\n\t}\n\n\treturn {\n\t\tget: get\n\t};\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/postbox/fetcher\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/postbox/fetcher',[\n\t'sandbox',\n\t'views/base',\n\t'utils/ajax',\n\t'utils/image',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction( $, BaseView, ajax, image, language ) {\n\n\treturn BaseView.extend({\n\n\t\ttemplate: joms.jst[ 'html/postbox/fetcher' ],\n\n\t\tevents: {\n\t\t\t'click .joms-fetched-close': 'onClose',\n\t\t\t'click .joms-fetched-field span': 'onFocus',\n\t\t\t'keyup .joms-fetched-field input': 'onKeyup',\n\t\t\t'keyup .joms-fetched-field textarea': 'onKeyup',\n\t\t\t'blur .joms-fetched-field input': 'onBlur',\n\t\t\t'blur .joms-fetched-field textarea': 'onBlur',\n\t\t\t'click .joms-fetched-previmg': 'prevImage',\n\t\t\t'click .joms-fetched-nextimg': 'nextImage'\n\t\t},\n\n\t\tinitialize: function() {\n\t\t\tvar lang = language.get('fetch') || {};\n\t\t\tthis.titlePlaceholder = lang.title_hint || '';\n\t\t\tthis.descPlaceholder = lang.description_hint || '';\n\t\t},\n\n\t\tfetch: function( text ) {\n\t\t\tvar rUrl = /^(|.*\\s)(https?:\\/\\/|www\\.)([a-z0-9-]+\\.)+[a-z]{2,4}(:\\d+)?(\\/.*)?(\\s.*|)$/i,\n\t\t\t\tisFetchable = text.match( rUrl );\n\n\t\t\tif ( this.fetching || !isFetchable )\n\t\t\t\treturn;\n\n\t\t\tthis.fetching = true;\n\t\t\tthis.fetched = false;\n\t\t\tdelete this.url;\n\n\t\t\tthis.trigger('fetch:start');\n\n\t\t\tajax({\n\t\t\t\tfn: 'system,ajaxGetFetchUrl',\n\t\t\t\tdata: [ text ],\n\t\t\t\tsuccess: $.bind( this.render, this ),\n\t\t\t\tcomplete: $.noop\n\t\t\t});\n\n\t\t},\n\n\t\trender: function( resp ) {\n\t\t\tresp = resp && resp[2] && resp[2][3] && resp[2][3][0] || false;\n\t\t\tif ( !resp )\n\t\t\t\treturn;\n\n\t\t\tvar json;\n\t\t\ttry {\n\t\t\t\tjson = JSON.parse( resp );\n\t\t\t} catch ( e ) {}\n\n\t\t\tif ( !json )\n\t\t\t\treturn;\n\n\t\t\tthis.fetched = true;\n\t\t\tthis.url = json.url || '';\n\n\t\t\tvar data = {\n\t\t\t\ttitle: json.title || '',\n\t\t\t\ttitlePlaceholder: this.titlePlaceholder,\n\t\t\t\tdescription: json.description || '',\n\t\t\t\tdescPlaceholder: this.descPlaceholder,\n\t\t\t\timage: json.image || []\n\t\t\t};\n\n\t\t\t// normalize url\n\t\t\tif ( !this.url.match( /^https?:\\/\\//i ) )\n\t\t\t\tthis.url = 'http://' + this.url;\n\n\t\t\t// normalize images\n\t\t\tfor ( var i = 0; i < data.image.length; i++ )\n\t\t\t\tif ( !data.image[i].match( /^(http:|https:)?\\/\\//i ) )\n\t\t\t\t\tdata.image[i] = '//' + data.image[i];\n\n\t\t\t// preload images\n\t\t\timage.preload( data.image, $.bind(function( images ) {\n\t\t\t\tdata.image = images;\n\t\t\t\tthis.$el.html( this.template( data ) );\n\t\t\t\tthis.$images = this.$('.joms-fetched-images').find('img');\n\t\t\t\tthis.$title = this.$('.joms-fetched-title').find('input');\n\t\t\t\tthis.$description = this.$('.joms-fetched-description').find('textarea');\n\t\t\t\tthis.fetching = false;\n\t\t\t\tthis.trigger('fetch:done');\n\t\t\t}, this ) );\n\t\t},\n\n\t\tchange: function( el ) {\n\t\t\tvar input = $( el ),\n\t\t\t\tspan = input.prev('span'),\n\t\t\t\tval = input.val().replace( /^\\s+|\\s+$/g, '' );\n\n\t\t\tif ( !val ) {\n\t\t\t\tval = input.parent().hasClass('joms-fetched-title') ?\n\t\t\t\t\tthis.titlePlaceholder :\n\t\t\t\t\tthis.descPlaceholder;\n\t\t\t}\n\n\t\t\tinput.hide();\n\t\t\tspan.text( val ).show();\n\t\t},\n\n\t\tremove: function() {\n\t\t\tdelete this.url;\n\t\t\tBaseView.prototype.remove.apply( this );\n\t\t\tthis.trigger('remove');\n\t\t},\n\n\t\tprevImage: function() {\n\t\t\tvar currImg = this.$images.filter(':visible'),\n\t\t\t\tprevImg = currImg.prev();\n\n\t\t\tif ( prevImg.length ) {\n\t\t\t\tcurrImg.hide();\n\t\t\t\tprevImg.show();\n\t\t\t}\n\t\t},\n\n\t\tnextImage: function() {\n\t\t\tvar currImg = this.$images.filter(':visible'),\n\t\t\t\tnextImg = currImg.next();\n\n\t\t\tif ( nextImg.length ) {\n\t\t\t\tcurrImg.hide();\n\t\t\t\tnextImg.show();\n\t\t\t}\n\t\t},\n\n\t\tvalue: function() {\n\t\t\tif ( this.fetching )\n\t\t\t\treturn [];\n\n\t\t\treturn [\n\t\t\t\tthis.url,\n\t\t\t\tthis.$images && this.$images.filter(':visible').attr('src'),\n\t\t\t\tthis.$title && this.$title.val().replace( /\\t/g, '\\\\t' ).replace( /\\n/g, '\\\\n' ),\n\t\t\t\tthis.$description && this.$description.val().replace( /\\t/g, '\\\\t' ).replace( /\\n/g, '\\\\n' )\n\t\t\t];\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonClose: function() {\n\t\t\tthis.remove();\n\t\t},\n\n\t\tonFocus: function( e ) {\n\t\t\tvar span = $( e.currentTarget ),\n\t\t\t\tinput = span.next('input,textarea');\n\n\t\t\tspan.hide();\n\t\t\tinput.show();\n\t\t\tsetTimeout(function() {\n\t\t\t\tinput[0].focus();\n\t\t\t}, 300 );\n\t\t},\n\n\t\tonKeyup: function( e ) {\n\t\t\tif ( e.keyCode === 13 ) {\n\t\t\t\tthis.change( e.currentTarget );\n\t\t\t}\n\t\t},\n\n\t\tonBlur: function( e ) {\n\t\t\tthis.change( e.currentTarget );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Ajax response parser.\n\t\t// ---------------------------------------------------------------------\n\n\t\tparseResponse: function( resp ) {\n\t\t\tresp = resp && resp[2] && resp[2][3] && resp[2][3][0] || false;\n\t\t\tif ( !resp )\n\t\t\t\treturn;\n\n\t\t\tvar json;\n\t\t\ttry {\n\t\t\t\tjson = JSON.parse( resp );\n\t\t\t} catch ( e ) {}\n\n\t\t\treturn json;\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/inputbox/base\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/inputbox/base',[\n\t'sandbox',\n\t'views/base',\n\t'utils/constants'\n],\n\n// definition\n// ----------\nfunction( $, BaseView, constants ) {\n\n\treturn BaseView.extend({\n\n\t\tevents: {\n\t\t\t'focus textarea': 'onFocus',\n\t\t\t'keydown textarea': 'onKeydownProxy',\n\t\t\t'input textarea': 'onInput',\n\t\t\t'paste textarea': 'onPaste',\n\t\t\t'blur textarea': 'onBlur'\n\t\t},\n\n\t\tinitialize: function( options ) {\n\t\t\tif ( !$.mobile ) {\n\t\t\t\tthis.onInput = $.noop;\n\t\t\t\tthis.onKeydownProxy = this.onKeydown;\n\t\t\t\tthis.updateCharCounterProxy = this.updateCharCounter;\n\t\t\t}\n\n\t\t\t// flags\n\t\t\toptions || (options = {});\n\t\t\tthis.flags = {};\n\t\t\tthis.flags.attachment = options.attachment;\n\t\t\tthis.flags.charcount = options.charcount;\n\n\t\t\tthis.listenTo( $, 'postbox:tab:change', this.reset );\n\t\t},\n\n\t\trender: function() {\n\t\t\tthis.$mirror = this.$('span.input');\n\t\t\tthis.$textarea = this.$('textarea.input');\n\t\t\tthis.placeholder = this.$textarea.attr('placeholder');\n\n\t\t\tif ( this.flags.attachment )\n\t\t\t\tthis.$attachment = $('<span class=attachment>').insertAfter( this.$mirror );\n\n\t\t\tthis.reset();\n\t\t},\n\n\t\tset: function( value ) {\n\t\t\tthis.$textarea.val( value );\n\t\t\tthis.flags.attachment && this.updateAttachment();\n\t\t\tthis.flags.charcount && this.updateCharCounterProxy();\n\t\t\tthis.onKeydownProxy();\n\t\t},\n\n\t\treset: function() {\n\t\t\tthis.$textarea.val('');\n\t\t\tthis.flags.attachment && this.updateAttachment();\n\t\t\tthis.flags.charcount && this.updateCharCounterProxy();\n\t\t\tthis.onKeydownProxy();\n\t\t},\n\n\t\tvalue: function() {\n\t\t\treturn this.$textarea[0].value;\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonFocus: function() {\n\t\t\tthis.trigger('focus');\n\t\t},\n\n\t\tonKeydown: function( e ) {\n\t\t\tvar that = this;\n\t\t\t$.defer(function() {\n\t\t\t\tthat.updateInput( e );\n\t\t\t});\n\t\t},\n\n\t\tonKeydownProxy: $.debounce(function( e ) {\n\t\t\tthis.onKeydown( e );\n\t\t}, 10 ),\n\n\t\t// Keydown event not always triggered on mobile browsers, so we listen both `keydown` and `input` events.\n\t\t// http://stackoverflow.com/questions/14194247/key-event-doesnt-trigger-in-firefox-on-android-when-word-suggestion-is-on\n\t\tonInput: function() {\n\t\t\tthis.onKeydownProxy();\n\t\t},\n\n\t\tonPaste: function() {\n\t\t\tvar that = this;\n\t\t\tthis.onKeydownProxy(function() {\n\t\t\t\tthat.trigger( 'paste', that.$textarea[0].value, 13 );\n\t\t\t});\n\t\t},\n\n\t\tonBlur: function() {\n\t\t\tthis.trigger( 'blur', this.$textarea[0].value, 13 );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Input renderer.\n\t\t// ---------------------------------------------------------------------\n\n\t\tupdateInput: function( e ) {\n\t\t\tvar keyCode  = e && e.keyCode || false,\n\t\t\t\ttextarea = this.$textarea[0],\n\t\t\t\tvalue    = textarea.value,\n\t\t\t\tisEmpty  = value.replace( /^\\s+|\\s+$/g, '' ) === '';\n\n\t\t\tif ( isEmpty )\n\t\t\t\ttextarea.value = value = '';\n\n\t\t\tthis.$mirror.html( this.normalize( value ) + '.' );\n\t\t\tthis.$textarea.css( 'height', this.$mirror.height() );\n\t\t\tthis.flags.charcount && this.updateCharCounterProxy();\n\t\t\tthis.trigger( 'keydown', value, keyCode );\n\t\t\tif ( typeof e === 'function' )\n\t\t\t\te();\n\t\t},\n\n\t\tupdateAttachment: $.noop,\n\n\t\tupdateCharCounterProxy: $.debounce(function() {\n\t\t\tthis.updateCharCounter();\n\t\t}, 300 ),\n\n\t\tupdateCharCounter: function() {\n\t\t\tif ( typeof this.maxchar === 'undefined' )\n\t\t\t\tthis.maxchar = +constants.get('conf.statusmaxchar') || 0;\n\n\t\t\tif ( !this.$charcount )\n\t\t\t\tthis.$charcount = this.$('.charcount');\n\n\t\t\tif ( !this.maxchar || this.maxchar <= 0 ) {\n\t\t\t\tthis.$charcount.hide();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$charcount.html( this.maxchar - this.$textarea[0].value.length ).show();\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Helper functions.\n\t\t// ---------------------------------------------------------------------\n\n\t\tnormalize: function( text ) {\n\t\t\treturn text\n\t\t\t\t.replace( /&/g, '&amp;' )\n\t\t\t\t.replace( /</g, '&lt;' )\n\t\t\t\t.replace( />/g, '&gt;' )\n\t\t\t\t.replace( /\\n/g, '<br>' );\n\t\t},\n\n\t\tresetTextntags: function( textarea, value ) {\n\t\t\tvar that = this;\n\n\t\t\ttextarea = $( textarea );\n\n\t\t\tif ( !textarea.data('initialized') ) {\n\t\t\t\ttextarea.data( 'initialized', 1 );\n\t\t\t\ttextarea.textntags({\n\t\t\t\t\ttriggers: { '@': {\n\t\t\t\t\t\tuniqueTags: true,\n\t\t\t\t\t\tminChars: 1\n\t\t\t\t\t} },\n\t\t\t\t\tonDataRequest: function( mode, query, triggerChar, callback ) {\n\t\t\t\t\t\tvar url = 'index.php?option=com_community&view=friends&task=ajaxAutocomplete',\n\t\t\t\t\t\t\tsettings = constants.get('settings');\n\n\t\t\t\t\t\tif ( settings.isGroup )\n\t\t\t\t\t\t\turl += '&groupid=' + constants.get('groupid');\n\t\t\t\t\t\telse if ( settings.isEvent )\n\t\t\t\t\t\t\turl += '&eventid=' + constants.get('eventid');\n\n\t\t\t\t\t\tif ( that.fetchTextntags )\n\t\t\t\t\t\t\tthat.fetchTextntags.abort();\n\n\t\t\t\t\t\tthat.fetchTextntags = $.ajax({\n\t\t\t\t\t\t\turl: url + '&query=' + query,\n\t\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\t\tsuccess: function( json ) {\n\t\t\t\t\t\t\t\tvar data = [],\n\t\t\t\t\t\t\t\t\ti;\n\n\t\t\t\t\t\t\t\tif ( json && json.suggestions && json.suggestions.length ) {\n\t\t\t\t\t\t\t\t\tfor ( i = 0; i < json.suggestions.length; i++ )\n\t\t\t\t\t\t\t\t\t\tdata.push({\n\t\t\t\t\t\t\t\t\t\t\tid: json.data[i],\n\t\t\t\t\t\t\t\t\t\t\tname: json.suggestions[i],\n\t\t\t\t\t\t\t\t\t\t\tavatar: json.img[i].replace( /^.+src=\"([^\"]+)\".+$/ , '$1'),\n\t\t\t\t\t\t\t\t\t\t\ttype: 'contact'\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tquery = query.toLowerCase();\n\t\t\t\t\t\t\t\t\tdata = $.filter( data, function( item ) { return item.name.toLowerCase().indexOf( query ) > -1; });\n\t\t\t\t\t\t\t\t\tcallback.call( this, data );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcomplete: function() {\n\t\t\t\t\t\t\t\tthat.fetchTextntags = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.bind( 'tagsAdded.textntags', function() { that.updateInput(); })\n\t\t\t\t.bind( 'tagsRemoved.textntags', function() { that.updateInput(); });\n\n\t\t\t}\n\n\t\t\ttextarea.textntags( 'val', value );\n\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/inputbox/status\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/inputbox/status',[\n\t'sandbox',\n\t'views/inputbox/base',\n\t'utils/constants',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction( $, InputboxView, constants, language ) {\n\n\treturn InputboxView.extend({\n\n\t\ttemplate: joms.jst[ 'html/inputbox/status' ],\n\n\t\tinitialize: function() {\n\t\t\tInputboxView.prototype.initialize.apply( this, arguments );\n\t\t\tthis.language = language.get('mood');\n\t\t},\n\n\t\trender: function() {\n\t\t\tvar div = this.getTemplate();\n\t\t\tthis.$el.replaceWith( div );\n\t\t\tthis.setElement( div );\n\t\t\tInputboxView.prototype.render.apply( this, arguments );\n\t\t},\n\n\t\tset: function( value ) {\n\t\t\tthis.resetTextntags( this.$textarea, value );\n\t\t\tthis.flags.attachment && this.updateAttachment( false, false );\n\t\t\tthis.flags.charcount && this.updateCharCounterProxy();\n\t\t\tthis.onKeydownProxy();\n\t\t},\n\n\t\treset: function() {\n\t\t\tthis.resetTextntags( this.$textarea, '' );\n\t\t\tthis.flags.attachment && this.updateAttachment( false, false );\n\t\t\tthis.flags.charcount && this.updateCharCounterProxy();\n\t\t\tthis.onKeydownProxy();\n\t\t},\n\n\t\tvalue: function() {\n\t\t\treturn this.textareaValue;\n\t\t},\n\n\t\tupdateInput: function() {\n\t\t\tInputboxView.prototype.updateInput.apply( this, arguments );\n\t\t\tvar that = this;\n\t\t\tthis.$textarea.textntags( 'val', function( text ) {\n\t\t\t\tthat.textareaValue = text;\n\t\t\t});\n\t\t},\n\n\t\tupdateAttachment: function( mood, location ) {\n\t\t\tvar attachment = [];\n\n\t\t\tthis.mood = mood || mood === false ? mood : this.mood;\n\t\t\tthis.location = location || location === false ? location : this.location;\n\n\t\t\tif ( this.location && this.location.name ) {\n\t\t\t\tattachment.push( '<b>at ' + this.location.name + '</b>' );\n\t\t\t}\n\n\t\t\tif ( this.mood ) {\n\t\t\t\tattachment.push(\n\t\t\t\t\t'<i class=\"joms-emoticon joms-emo-' + this.mood + '\"></i> ' +\n\t\t\t\t\t'<b>' + ( this.language[ this.mood ] || this.mood ) + '</b>'\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif ( !attachment.length ) {\n\t\t\t\tthis.$attachment.html('');\n\t\t\t\tthis.$textarea.attr( 'placeholder', this.placeholder );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$attachment.html( ' &nbsp;&mdash; ' + attachment.join(' and ') + '.' );\n\t\t\tthis.$textarea.removeAttr('placeholder');\n\t\t},\n\n\t\tgetTemplate: function() {\n\t\t\tvar hint = language.get('status.status_hint') || '',\n\t\t\t\thtml = this.template({ placeholder: hint });\n\n\t\t\treturn $( html );\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/dropdown/base\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/dropdown/base',[\n\t'sandbox',\n\t'views/base'\n],\n\n// definition\n// ----------\nfunction( $, BaseView ) {\n\n\treturn BaseView.extend({\n\n\t\tinitialize: function() {\n\t\t\tthis.listenTo( $, 'click', this._onDocumentClick );\n\t\t},\n\n\t\t// hide on there is onclick event outside postbox\n\t\t_onDocumentClick: function( elem ) {\n\t\t\tif ( !elem.closest('.joms-postbox').length )\n\t\t\t\tthis.hide();\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/dropdown/mood\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/dropdown/mood',[\n\t'sandbox',\n\t'views/dropdown/base',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction( $, BaseView, language ) {\n\n\treturn BaseView.extend({\n\n\t\ttemplate: joms.jst[ 'html/dropdown/mood' ],\n\n\t\tevents: {\n\t\t\t'click li': 'onSelect',\n\t\t\t'click .joms-remove-button': 'onRemove'\n\t\t},\n\n\t\tmoods: [\n\t\t\t'happy',\n\t\t\t'meh',\n\t\t\t'sad',\n\t\t\t'loved',\n\t\t\t'excited',\n\t\t\t'pretty',\n\t\t\t'tired',\n\t\t\t'angry',\n\t\t\t'speachless',\n\t\t\t'shocked',\n\t\t\t'irretated',\n\t\t\t'sick',\n\t\t\t'annoyed',\n\t\t\t'relieved',\n\t\t\t'blessed',\n\t\t\t'bored'\n\t\t],\n\n\t\trender: function() {\n\t\t\tvar html = this.template({\n\t\t\t\t\titems: this.moods,\n\t\t\t\t\tlanguage: {\n\t\t\t\t\t\tstatus: language.get('status') || {},\n\t\t\t\t\t\tmoodshort: language.get('moodshort') || {}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tdiv = $( html ).hide();\n\n\t\t\tthis.$el.replaceWith( div );\n\t\t\tthis.setElement( div );\n\n\t\t\tthis.$btnremove = this.$('.joms-remove-button').hide();\n\n\t\t\treturn this;\n\t\t},\n\n\t\tselect: function( mood ) {\n\t\t\tif ( this.moods.indexOf( mood ) >= 0 ) {\n\t\t\t\tthis.$btnremove.show();\n\t\t\t\tthis.trigger( 'select', this.mood = mood );\n\t\t\t}\n\t\t},\n\n\t\tvalue: function() {\n\t\t\treturn this.mood;\n\t\t},\n\n\t\treset: function() {\n\t\t\tthis.mood = false;\n\t\t\tthis.$btnremove.hide();\n\t\t\tthis.trigger('reset');\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonSelect: function( e ) {\n\t\t\tvar item = $( e.currentTarget ),\n\t\t\t\tmood = item.attr('data-mood');\n\n\t\t\tthis.select( mood );\n\t\t\tthis.hide();\n\t\t},\n\n\t\tonRemove: function() {\n\t\t\tthis.mood = false;\n\t\t\tthis.$btnremove.hide();\n\t\t\tthis.trigger('remove');\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/dropdown/location\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/dropdown/location',[\n\t'sandbox',\n\t'views/dropdown/base',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction( $, BaseView, language ) {\n\n\t// placeholders language setting.\n\tvar langs = language.get('geolocation') || {};\n\n\treturn BaseView.extend({\n\n\t\ttemplate: {\n\t\t\tdiv: joms.jst[ 'html/dropdown/location' ],\n\t\t\tlist: joms.jst[ 'html/dropdown/location-list' ]\n\t\t},\n\n\t\tplaceholders: {\n\t\t\tloading: langs.loading || '',\n\t\t\tloaded: langs.loaded || '',\n\t\t\terror: langs.error || ''\n\t\t},\n\n\t\tinitialize: function() {\n\t\t\tBaseView.prototype.initialize.apply( this );\n\n\t\t\tthis.locations = [];\n\t\t\tthis.location = false;\n\t\t\tthis.listenTo( $, 'postbox:tab:change', this.onRemove );\n\t\t},\n\n\t\tevents: {\n\t\t\t'keyup input.joms-postbox-keyword': 'onKeyup',\n\t\t\t'click li': 'onSelect',\n\t\t\t'click button.joms-add-location': 'onAdd',\n\t\t\t'click button.joms-remove-location': 'onRemove'\n\t\t},\n\n\t\trender: function() {\n\t\t\tthis.$el.html( this.getTemplate() );\n\t\t\tthis.$keyword = this.$('.joms-postbox-keyword');\n\t\t\tthis.$list = this.$('.joms-postbox-locations');\n\t\t\tthis.$map = this.$('.joms-postbox-map');\n\t\t\tthis.$btnadd = this.$('.joms-add-location').hide();\n\t\t\tthis.$btnremove = this.$('.joms-remove-location').hide();\n\n\t\t\tthis.$keyword.attr( 'placeholder', this.placeholders.loading );\n\t\t\tthis.detectLocation();\n\n\t\t\treturn this;\n\t\t},\n\n\t\tshow: function() {\n\t\t\tthis.$el.show();\n\t\t\tthis.trigger('show');\n\t\t},\n\n\t\thide: function() {\n\t\t\tthis.$el.hide();\n\t\t\tthis.trigger('hide');\n\t\t},\n\n\t\ttoggle: function() {\n\t\t\tvar hidden = this.el.style.display === 'none';\n\t\t\thidden ? this.show() : this.hide();\n\t\t},\n\n\t\tfilter: function() {\n\t\t\tvar keyword = this.$keyword.val().replace( /^\\s+|\\s+$/, '' ),\n\t\t\t\tfiltered = this.locations;\n\n\t\t\tif ( keyword.length ) {\n\t\t\t\tkeyword = new RegExp( keyword, 'i' );\n\t\t\t\tfiltered = [];\n\t\t\t\tfor ( var i = 0, item; i < this.locations.length; i++ ) {\n\t\t\t\t\titem = this.locations[i];\n\t\t\t\t\titem = [ item.name, item.vicinity ].join(' ');\n\t\t\t\t\tif ( item.match(keyword) )\n\t\t\t\t\t\tfiltered.push( this.locations[i] );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.draw( filtered );\n\t\t},\n\n\t\tdraw: function( items ) {\n\t\t\tvar html = this.template.list({\n\t\t\t\tlanguage: { geolocation: language.get('geolocation') },\n\t\t\t\titems: items\n\t\t\t});\n\n\t\t\tthis.filtered = items;\n\n\t\t\tif ( $.mobile ) {\n\t\t\t\tthis.$list.html( html ).css({\n\t\t\t\t\theight: '160px',\n\t\t\t\t\toverflowY: 'auto'\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.$list.html( html ).slimScroll({\n\t\t\t\t\theight: '150px',\n\t\t\t\t\talwaysVisible: true\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tselect: function( index ) {\n\t\t\tvar data = this.filtered[ index ];\n\t\t\tif ( data ) {\n\t\t\t\tthis.location = data;\n\t\t\t\tthis.$map.show();\n\t\t\t\tthis.$keyword.val( data.name );\n\t\t\t\tthis.map && this.marker && this.marker.setMap( this.map );\n\t\t\t\tthis.showMap( data.latitude, data.longitude );\n\t\t\t\tthis.$btnadd.show();\n\t\t\t\tthis.$btnremove.hide();\n\t\t\t}\n\t\t},\n\n\t\tvalue: function() {\n\t\t\tvar data = [];\n\n\t\t\tif ( this.location ) {\n\t\t\t\tdata.push( this.location.name );\n\t\t\t\tdata.push( this.location.latitude );\n\t\t\t\tdata.push( this.location.longitude );\n\t\t\t\treturn data;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\t\treset: function() {\n\t\t\tthis.location = false;\n\t\t\tthis.marker && this.marker.setMap( null );\n\t\t\tthis.$keyword.val('');\n\t\t\tthis.$btnadd.hide();\n\t\t\tthis.$btnremove.hide();\n\t\t\tthis.trigger('reset');\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonKeyup: $.debounce(function() {\n\t\t\tthis.filter();\n\t\t}, 100 ),\n\n\t\tonSelect: function( e ) {\n\t\t\tvar el = $( e.currentTarget ),\n\t\t\t\tindex = el.attr('data-index');\n\n\t\t\tthis.select( +index );\n\t\t},\n\n\t\tonAdd: function() {\n\t\t\tif ( this.location ) {\n\t\t\t\tthis.trigger( 'select', this.location );\n\t\t\t\tthis.$btnadd.hide();\n\t\t\t\tthis.$btnremove.show();\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t},\n\n\t\tonRemove: function() {\n\t\t\tthis.reset();\n\t\t\tthis.trigger('remove');\n\t\t\tthis.hide();\n\t\t\tthis.filter();\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Map functions.\n\t\t// ---------------------------------------------------------------------\n\n\t\tinitMap: function( position ) {\n\t\t\tvar el = $('<div>').prependTo( this.$map );\n\t\t\tel.css( 'height', 110 );\n\n\t\t\tvar options = {\n\t\t\t\tcenter: position,\n\t\t\t\tzoom: 14,\n\t\t\t\tmapTypeId: google.maps.MapTypeId.ROADMAD,\n\t\t\t\tmapTypeControl: false,\n\t\t\t\tdisableDefaultUI: true,\n\t\t\t\tdraggable: false,\n\t\t\t\tscaleControl: false,\n\t\t\t\tscrollwheel: false,\n\t\t\t\tnavigationControl: false,\n\t\t\t\tstreetViewControl: false,\n\t\t\t\tdisableDoubleClickZoom: true\n\t\t\t};\n\n\t\t\tthis.map = new google.maps.Map( el[0], options );\n\t\t\tthis.marker = new google.maps.Marker({\n\t\t\t\tdraggable: false,\n\t\t\t\tmap: this.map\n\t\t\t});\n\t\t\tthis.marker.setAnimation( null );\n\t\t},\n\n\t\tshowMap: function( lat, lng ) {\n\t\t\tvar position = $.isUndefined( lng ) ? lat : new google.maps.LatLng( lat, lng );\n\n\t\t\tif ( !this.map ) {\n\t\t\t\tthis.initMap( position );\n\t\t\t}\n\n\t\t\tthis.marker.setPosition( position );\n\t\t\tthis.map.panTo( position );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Location detection.\n\t\t// ---------------------------------------------------------------------\n\n\t\tdetectLocation: function() {\n\t\t\tnavigator.geolocation.getCurrentPosition(\n\t\t\t\t$.bind( this.detectLocationSuccess, this ),\n\t\t\t\t$.bind( this.detectLocationFallback, this ),\n\t\t\t\t{ timeout: 10000 }\n\t\t\t);\n\t\t},\n\n\t\tdetectLocationSuccess: function( position ) {\n\t\t\tvar coords = position && position.coords || {},\n\t\t\t\tlat = coords.latitude,\n\t\t\t\tlng = coords.longitude;\n\n\t\t\tif ( !lat || !lng ) {\n\t\t\t\tthis.detectLocationFailed();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.detectLocationNearby( lat, lng );\n\t\t},\n\n\t\t// If HTML5 geolocation failed to detect my current location, attempt to use IP-based geolocation.\n\t\tdetectLocationFallback: function () {\n\t\t\tvar success = false,\n\t\t\t\tthat = this;\n\n\t\t\t$.ajax({\n\t\t\t\turl: '//freegeoip.net/json/',\n\t\t\t\tdataType: 'jsonp',\n\t\t\t\tsuccess: function( json ) {\n\t\t\t\t\tvar lat = json.latitude,\n\t\t\t\t\t\tlng = json.longitude;\n\n\t\t\t\t\tif ( lat && lng ) {\n\t\t\t\t\t\tsuccess = true;\n\t\t\t\t\t\tthat.detectLocationNearby( lat, lng );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tif ( !success )\n\t\t\t\t\t\tthat.detectLocationFailed();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tdetectLocationFailed: function() {\n\t\t\tthis.$keyword.attr( 'placeholder', this.placeholders.error );\n\t\t},\n\n\t\tdetectLocationNearby: function( lat, lng ) {\n\t\t\tvar position = $.isUndefined( lng ) ? lat : new google.maps.LatLng( lat, lng );\n\t\t\tthis.initMap( position );\n\n\t\t\tvar service = new google.maps.places.PlacesService( this.map );\n\t\t\tvar request = {\n\t\t\t\tlocation: new google.maps.LatLng( lat, lng ),\n\t\t\t\tradius: 100\n\t\t\t};\n\n\t\t\tthis.locations = [];\n\n\t\t\tvar that = this;\n\t\t\tservice.nearbySearch( request, function( results, status ) {\n\t\t\t\tif ( status !== google.maps.places.PlacesServiceStatus.OK ) {\n\t\t\t\t\tthat.detectLocationFailed();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( !$.isArray(results) ) {\n\t\t\t\t\tthat.detectLocationFailed();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfor ( var i = 0, loc; i < results.length; i++ ) {\n\t\t\t\t\tloc = results[i];\n\t\t\t\t\tthat.locations.push({\n\t\t\t\t\t\tname: loc.name,\n\t\t\t\t\t\tlatitude: loc.geometry.location.lat(),\n\t\t\t\t\t\tlongitude: loc.geometry.location.lng(),\n\t\t\t\t\t\tvicinity: loc.vicinity\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthat.$keyword.attr( 'placeholder', that.placeholders.loaded );\n\t\t\t\tthat.filter();\n\t\t\t});\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Helper functions.\n\t\t// ---------------------------------------------------------------------\n\n\t\tgetTemplate: function() {\n\t\t\tvar html = this.template.div({\n\t\t\t\tlanguage: {\n\t\t\t\t\tgeolocation: language.get('geolocation') || {}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn html;\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/dropdown/privacy\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/dropdown/privacy',[\n\t'sandbox',\n\t'views/dropdown/base',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction( $, BaseView, language ) {\n\n\treturn BaseView.extend({\n\n\t\ttemplate: joms.jst[ 'html/dropdown/privacy' ],\n\n\t\tevents: { 'click li': 'select' },\n\n\t\tprivacies: {\n\t\t\t'public': [ 10, 'globe' ],\n\t\t\t'site_members': [ 20, 'users' ],\n\t\t\t'friends': [ 30, 'user' ],\n\t\t\t'me': [ 40, 'lock' ]\n\t\t},\n\n\t\tprivmaps: {\n\t\t\t'public': '10',\n\t\t\t'site_members': '20',\n\t\t\t'friends': '30',\n\t\t\t'me': '40',\n\t\t\t'0': 'public',\n\t\t\t'10': 'public',\n\t\t\t'20': 'site_members',\n\t\t\t'30': 'friends',\n\t\t\t'40': 'me'\n\t\t},\n\n\t\tinitialize: function( options ) {\n\t\t\tBaseView.prototype.initialize.apply( this );\n\n\t\t\tthis.privkeys = $.keys( this.privacies );\n\t\t\tif ( options && options.privacylist && options.privacylist.length )\n\t\t\t\tthis.privkeys = $.intersection( this.privkeys, options.privacylist );\n\n\t\t\tvar langs = language.get('privacy') || {};\n\t\t\tfor ( var prop in this.privacies ) {\n\t\t\t\tthis.privacies[ prop ][ 2 ] = langs[ prop ] || prop;\n\t\t\t\tthis.privacies[ prop ][ 3 ] = langs[ prop + '_desc' ] || prop;\n\t\t\t}\n\n\t\t\t// set default privacy\n\t\t\tthis.defaultPrivacy = this.privkeys[0];\n\t\t\tif ( typeof options.defaultPrivacy !== 'undefined' ) {\n\t\t\t\toptions.defaultPrivacy = '' + options.defaultPrivacy;\n\t\t\t\tif ( options.defaultPrivacy.match(/^\\d+$/) )\n\t\t\t\t\toptions.defaultPrivacy = this.privmaps[ options.defaultPrivacy ] || this.defaultPrivacy;\n\t\t\t\tthis.defaultPrivacy = options.defaultPrivacy;\n\t\t\t}\n\t\t},\n\n\t\trender: function() {\n\t\t\tvar items = [];\n\t\t\tfor ( var i = 0, priv; i < this.privkeys.length; i++ ) {\n\t\t\t\tpriv = this.privkeys[ i ];\n\t\t\t\titems[ i ] = [\n\t\t\t\t\tpriv,\n\t\t\t\t\tthis.privacies[ priv ][ 1 ],\n\t\t\t\t\tthis.privacies[ priv ][ 2 ],\n\t\t\t\t\tthis.privacies[ priv ][ 3 ]\n\t\t\t\t];\n\t\t\t}\n\n\t\t\tthis.$el.html( this.template({ items: items }) );\n\t\t\tthis.setPrivacy( this.defaultPrivacy );\n\t\t\treturn this;\n\t\t},\n\n\t\tselect: function( e ) {\n\t\t\tvar item = $( e.currentTarget ),\n\t\t\t\tpriv = item.attr('data-priv');\n\n\t\t\tthis.setPrivacy( priv );\n\t\t\tthis.hide();\n\t\t},\n\n\t\tsetPrivacy: function( priv ) {\n\t\t\tvar data = {};\n\n\t\t\tif ( this.privkeys.indexOf( priv ) >= 0 ) {\n\t\t\t\tthis.privacy = this.privacies[ priv ][ 0 ];\n\t\t\t\tdata.icon = this.privacies[ priv ][ 1 ];\n\t\t\t\tdata.label = this.privacies[ priv ][ 2 ].toLowerCase();\n\t\t\t\tthis.trigger( 'select', data );\n\t\t\t}\n\t\t},\n\n\t\tvalue: function() {\n\t\t\treturn this.privacy;\n\t\t},\n\n\t\treset: function() {\n\t\t\tthis.setPrivacy( this.defaultPrivacy );\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/postbox/status\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/postbox/status',[\n\t'sandbox',\n\t'app',\n\t'views/postbox/default',\n\t'views/postbox/fetcher',\n\t'views/inputbox/status',\n\t'views/dropdown/mood',\n\t'views/dropdown/location',\n\t'views/dropdown/privacy',\n\t'utils/constants',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction(\n\t$,\n\tApp,\n\tDefaultView,\n\tFetcherView,\n\tInputboxView,\n\tMoodView,\n\tLocationView,\n\tPrivacyView,\n\tconstants,\n\tlanguage\n) {\n\n\treturn DefaultView.extend({\n\n\t\tsubviews: {\n\t\t\tmood: MoodView,\n\t\t\tlocation: LocationView,\n\t\t\tprivacy: PrivacyView\n\t\t},\n\n\t\ttemplate: joms.jst[ 'html/postbox/status' ],\n\n\t\tevents: $.extend({}, DefaultView.prototype.events, {\n\t\t\t'click li[data-tab=photo]': 'onAddPhoto',\n\t\t\t'click li[data-tab=video]': 'onAddVideo'\n\t\t}),\n\n\t\tinitialize: function() {\n\t\t\tvar settings = constants.get('settings') || {};\n\t\t\tif ( this.inheritPrivacy = (settings.isGroup || settings.isEvent || !settings.isMyProfile))\n\t\t\t\tthis.subviews = $.omit( this.subviews, 'privacy' );\n\n\t\t\tthis.enableMood = +constants.get('conf.enablemood');\n\t\t\tif ( !this.enableMood )\n\t\t\t\tthis.subviews = $.omit( this.subviews, 'mood' );\n\n\t\t\tthis.enableLocation = +constants.get('conf.enablelocation');\n\t\t\tif ( !this.enableLocation )\n\t\t\t\tthis.subviews = $.omit( this.subviews, 'location' );\n\n\t\t\tDefaultView.prototype.initialize.apply( this );\n\t\t},\n\n\t\trender: function() {\n\t\t\tDefaultView.prototype.render.apply( this );\n\n\t\t\tthis.$inputbox = this.$('.joms-postbox-inputbox');\n\t\t\tthis.$fetcher = this.$('.joms-postbox-fetched');\n\t\t\tthis.$tabmood = this.$tabs.find('[data-tab=mood]');\n\t\t\tthis.$tablocation = this.$tabs.find('[data-tab=location]');\n\t\t\tthis.$tabprivacy = this.$tabs.find('[data-tab=privacy]');\n\n\t\t\tif ( !this.enableMood )\n\t\t\t\tthis.$tabmood.remove();\n\n\t\t\tif ( !this.enableLocation )\n\t\t\t\tthis.$tablocation.remove();\n\n\t\t\tif ( this.inheritPrivacy ) {\n\t\t\t\tif ( this.$tabprivacy.next().length )\n\t\t\t\t\tthis.$tabprivacy.remove();\n\t\t\t\telse\n\t\t\t\t\tthis.$tabprivacy.css({ visibility: 'hidden' });\n\t\t\t}\n\n\t\t\t// inputbox\n\t\t\tthis.inputbox = new InputboxView({ attachment: true, charcount: true });\n\t\t\tthis.assign( this.$inputbox, this.inputbox );\n\t\t\tthis.listenTo( this.inputbox, 'focus', this.onInputFocus );\n\t\t\tthis.listenTo( this.inputbox, 'keydown', this.onInputUpdate );\n\n\t\t\t// init privacy\n\t\t\tvar defaultPrivacy, settings;\n\t\t\tif ( !this.inheritPrivacy ) {\n\t\t\t\tsettings = constants.get('settings') || {};\n\t\t\t\tif ( settings.isProfile && settings.isMyProfile )\n\t\t\t\t\tdefaultPrivacy = constants.get('conf.profiledefaultprivacy');\n\t\t\t\tthis.initSubview('privacy', { defaultPrivacy: defaultPrivacy || 'public' });\n\t\t\t}\n\n\t\t\tif ( this.single )\n\t\t\t\tthis.listenTo( $, 'click', this.onDocumentClick );\n\n\t\t\treturn this;\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Data validation and retrieval.\n\t\t// ---------------------------------------------------------------------\n\n\t\treset: function() {\n\t\t\tDefaultView.prototype.reset.apply( this );\n\t\t\tthis.inputbox && this.inputbox.reset();\n\t\t\tthis.fetcher && this.fetcher.remove();\n\t\t},\n\n\t\tvalue: function() {\n\t\t\tthis.data.text = this.inputbox.value() || '';\n\t\t\tthis.data.attachment = {};\n\n\t\t\tthis.data.text = this.data.text.replace( /\\n/g, '\\\\n' );\n\n\t\t\tvar value;\n\t\t\tfor ( var prop in this.subflags )\n\t\t\t\tif ( value = this.subviews[ prop ].value() )\n\t\t\t\t\tthis.data.attachment[ prop ] = value;\n\n\t\t\tif ( this.fetcher )\n\t\t\t\tthis.data.attachment.fetch = this.fetcher.value();\n\n\t\t\treturn DefaultView.prototype.value.apply( this, arguments );\n\t\t},\n\n\t\tvalidate: $.noop,\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Inputbox event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonInputFocus: function() {\n\t\t\tthis.showMainState();\n\t\t},\n\n\t\tonInputUpdate: function( text, key ) {\n\t\t\tvar div;\n\n\t\t\ttext = text || '';\n\t\t\tthis.togglePostButton( text );\n\n\t\t\tif ( key === 32 || key === 13 ) {\n\t\t\t\tif ( this.fetcher && this.fetcher.fetched )\n\t\t\t\t\treturn;\n\n\t\t\t\tif ( this.fetcher )\n\t\t\t\t\tthis.fetcher.remove();\n\n\t\t\t\tdiv = $('<div>').appendTo( this.$fetcher );\n\t\t\t\tthis.fetcher = new FetcherView();\n\t\t\t\tthis.fetcher.setElement( div );\n\t\t\t\tthis.listenTo( this.fetcher, 'fetch:start', this.onFetchStart );\n\t\t\t\tthis.listenTo( this.fetcher, 'fetch:done', this.onFetchDone );\n\t\t\t\tthis.listenTo( this.fetcher, 'remove', this.onFetchRemove );\n\t\t\t\tthis.fetcher.fetch( text.replace( /^\\s+|\\s+$/g, '' ) );\n\t\t\t}\n\t\t},\n\n\t\tonFetchStart: function() {\n\t\t\tthis.saving = true;\n\t\t\tthis.$loading.show();\n\t\t},\n\n\t\tonFetchDone: function() {\n\t\t\tthis.$loading.hide();\n\t\t\tthis.saving = false;\n\t\t},\n\n\t\tonFetchRemove: function() {\n\t\t\tthis.fetcher = false;\n\t\t},\n\n\t\tonDocumentClick: function( elem ) {\n\t\t\tif ( elem.closest('.joms-postbox').length )\n\t\t\t\treturn;\n\n\t\t\tvar text = this.inputbox.value();\n\t\t\ttext = text.replace( /^\\s+|\\s+$/g, '' );\n\t\t\tif ( !text )\n\t\t\t\tthis.showInitialState();\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Dropdowns event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonMoodSelect: function( mood ) {\n\t\t\tthis.inputbox.updateAttachment( mood );\n\t\t\tthis.togglePostButton();\n\t\t},\n\n\t\tonMoodRemove: function() {\n\t\t\tthis.inputbox.updateAttachment( false );\n\t\t\tthis.togglePostButton();\n\t\t},\n\n\t\tonLocationSelect: function( location ) {\n\t\t\tthis.inputbox.updateAttachment( null, location );\n\t\t\tthis.togglePostButton();\n\t\t},\n\n\t\tonLocationRemove: function() {\n\t\t\tthis.inputbox.updateAttachment( null, false );\n\t\t\tthis.togglePostButton();\n\t\t},\n\n\t\tonPrivacySelect: function( data ) {\n\t\t\tthis.$tabprivacy.find('i').attr( 'class', 'joms-icon-' + data.icon );\n\t\t\tthis.$tabprivacy.find('span').html( data.label );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Add photo/video event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonAddPhoto: function() {\n\t\t\tApp.postbox || (App.postbox = {});\n\t\t\tApp.postbox.value = this.value( true );\n\t\t\t$.trigger( 'postbox:photo' );\n\t\t},\n\n\t\tonAddVideo: function() {\n\t\t\tApp.postbox || (App.postbox = {});\n\t\t\tApp.postbox.value = this.value( true );\n\t\t\t$.trigger( 'postbox:video' );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Helper functions.\n\t\t// ---------------------------------------------------------------------\n\n\t\tgetTemplate: function() {\n\t\t\tvar settings = constants.get('settings') || {},\n\t\t\t\tconf = constants.get('conf') || {},\n\t\t\t\tenablephoto = true,\n\t\t\t\tenablevideo = true;\n\n\t\t\tif ( settings.isEvent ) {\n\t\t\t\tenablephoto = enablevideo = false;\n\t\t\t} else if ( settings.isProfile || settings.isGroup ) {\n\t\t\t\tconf.enablephotos || (enablephoto = false);\n\t\t\t\tconf.enablevideos || (enablevideo = false);\n\t\t\t}\n\n\t\t\tvar html = this.template({\n\t\t\t\tjuri: constants.get('juri'),\n\t\t\t\tenablephoto: enablephoto,\n\t\t\t\tenablevideo: enablevideo,\n\t\t\t\tlanguage: {\n\t\t\t\t\tpostbox: language.get('postbox') || {},\n\t\t\t\t\tstatus: language.get('status') || {}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn $( html ).hide();\n\t\t},\n\n\t\tgetStaticAttachment: function() {\n\t\t\tif ( this.staticAttachment )\n\t\t\t\treturn this.staticAttachment;\n\n\t\t\tthis.staticAttachment = $.extend({},\n\t\t\t\tconstants.get('postbox.attachment') || {},\n\t\t\t\t{ type: 'message' }\n\t\t\t);\n\n\t\t\treturn this.staticAttachment;\n\t\t},\n\n\t\ttogglePostButton: function( text ) {\n\t\t\tvar enabled = false;\n\n\t\t\tif ( text )\n\t\t\t\tenabled = true;\n\n\t\t\tif ( !enabled && this.subflags.mood )\n\t\t\t\tenabled = this.subviews.mood.value();\n\n\t\t\tif ( !enabled && this.subflags.location )\n\t\t\t\tenabled = this.subviews.location.value();\n\n\t\t\tthis.$save[ enabled ? 'show' : 'hide' ]();\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/widget/select\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/widget/select',[\n\t'sandbox',\n\t'views/base'\n],\n\n// definition\n// ----------\nfunction( $, BaseView ) {\n\n\treturn BaseView.extend({\n\n\t\ttemplate: joms.jst[ 'html/widget/select' ],\n\n\t\tevents: {\n\t\t\t'click span': 'toggle',\n\t\t\t'click li': 'onSelect'\n\t\t},\n\n\t\tinitialize: function( options ) {\n\t\t\tthis.options = options.options || [];\n\t\t\tif ( +options.width )\n\t\t\t\tthis.width = +options.width + 'px';\n\t\t},\n\n\t\trender: function() {\n\t\t\tvar data = {};\n\t\t\tdata.options = this.options;\n\t\t\tdata.width = this.width || false;\n\n\t\t\tthis.$el.html( this.template( data ) );\n\t\t\tthis.$span = this.$('span');\n\t\t\tthis.$ul = this.$('ul');\n\n\t\t\tif ( data.options ) {\n\t\t\t\tif ( data.options.length > 6 ) {\n\t\t\t\t\tthis.$ul.slimScroll({ height: '165px', alwaysVisible: true });\n\t\t\t\t\tthis.$ul = this.$ul.closest('.slimScrollDiv').hide();\n\t\t\t\t\tthis.$ul.css({ position: 'absolute', width: '100%' });\n\t\t\t\t\tthis.$ul.find('ul').css({ display: '', width: '' });\n\t\t\t\t}\n\t\t\t\tif ( data.options[0] )\n\t\t\t\t\tthis.select( data.options[0][0], data.options[0][1] );\n\t\t\t}\n\t\t},\n\n\t\tselect: function( value, text ) {\n\t\t\tthis.$span.html( text );\n\t\t\tthis.$span.data( 'value', value );\n\t\t\tthis.trigger( 'select', value, text );\n\t\t},\n\n\t\ttoggle: function() {\n\t\t\tthis.$ul.toggle();\n\t\t},\n\n\t\tvalue: function() {\n\t\t\treturn this.$span.data('value');\n\t\t},\n\n\t\treset: function() {\n\t\t\tthis.$ul && this.$ul.hide();\n\t\t\tif ( this.options && this.options.length ) {\n\t\t\t\tthis.$span.html( this.options[0][1] );\n\t\t\t\tthis.$span.data( 'value', this.options[0][0] );\n\t\t\t}\n\t\t},\n\n\t\tonSelect: function( e ) {\n\t\t\tvar el = $( e.currentTarget ),\n\t\t\t\tvalue = el.data('value'),\n\t\t\t\ttext = el.html();\n\n\t\t\tthis.select( value, text );\n\t\t\tthis.toggle();\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/widget/select-album\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/widget/select-album',[\n\t'sandbox',\n\t'views/widget/select'\n],\n\n// definition\n// ----------\nfunction( $, SelectWidget ) {\n\n\treturn SelectWidget.extend({\n\n\t\ttemplate: joms.jst[ 'html/widget/select-album' ],\n\n\t\trender: function() {\n\t\t\tvar data = {};\n\t\t\tdata.options = this.options;\n\t\t\tdata.width = this.width || false;\n\n\t\t\tthis.$el.html( this.template( data ) );\n\t\t\tthis.$span = this.$('span');\n\t\t\tthis.$ul = this.$('ul');\n\n\t\t\tif ( data.options ) {\n\t\t\t\tif ( data.options.length > 3 ) {\n\t\t\t\t\tthis.$ul.slimScroll({ height: '150px', alwaysVisible: true });\n\t\t\t\t\tthis.$ul = this.$ul.closest('.slimScrollDiv').hide();\n\t\t\t\t\tthis.$ul.css({ position: 'absolute', width: '100%' });\n\t\t\t\t\tthis.$ul.find('ul').css({ display: '', width: '' });\n\t\t\t\t}\n\t\t\t\tif ( data.options[0] )\n\t\t\t\t\tthis.select( data.options[0][0], data.options[0][1] );\n\t\t\t}\n\t\t},\n\n\t\tonSelect: function( e ) {\n\t\t\tvar el = $( e.currentTarget ),\n\t\t\t\tvalue = el.data('value'),\n\t\t\t\ttext = el.find('p').html();\n\n\t\t\tthis.select( value, text );\n\t\t\tthis.toggle();\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/postbox/photo-preview\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/postbox/photo-preview',[\n\t'sandbox',\n\t'app',\n\t'views/base',\n\t'views/widget/select-album',\n\t'utils/ajax',\n\t'utils/constants',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction( $, App, BaseView, SelectWidget, ajax, constants, language ) {\n\n\treturn BaseView.extend({\n\n\t\ttemplates: {\n\t\t\tdiv: joms.jst[ 'html/postbox/photo-preview' ],\n\t\t\timg: joms.jst[ 'html/postbox/photo-item' ]\n\t\t},\n\n\t\tevents: {\n\t\t\t'click .joms-postbox-photo-remove': 'onRemove'\n\t\t},\n\n\t\trender: function() {\n\t\t\tthis.$el.html( this.templates.div() );\n\t\t\tthis.$list = this.$('ul');\n\t\t\tthis.$form = this.$('div.joms-postbox-photo-form');\n\t\t},\n\n\t\tadd: function( file ) {\n\t\t\tthis.$list.append( this.templates.img({\n\t\t\t\tid: this.getFileId( file ),\n\t\t\t\tsrc: App.legacyUrl + '/assets/photo-upload-placeholder.png'\n\t\t\t}) );\n\n\t\t\tif ( this.select )\n\t\t\t\treturn;\n\n\t\t\tvar albums = constants.get('album'),\n\t\t\t\tprivs = language.get('privacy'),\n\t\t\t\toptions = [];\n\n\t\t\tvar privmap = {\n\t\t\t\t'0': 'public',\n\t\t\t\t'10': 'public',\n\t\t\t\t'20': 'site_members',\n\t\t\t\t'30': 'friends',\n\t\t\t\t'40': 'me'\n\t\t\t};\n\n\t\t\tvar icons = {\n\t\t\t\t'0': 'globe',\n\t\t\t\t'10': 'public',\n\t\t\t\t'20': 'users',\n\t\t\t\t'30': 'user',\n\t\t\t\t'40': 'lock'\n\t\t\t};\n\n\t\t\tif ( !(albums && albums.length) )\n\t\t\t\treturn;\n\n\t\t\tthis.albummap = {};\n\t\t\tfor ( var i = 0, album, permission; i < albums.length; i++ ) {\n\t\t\t\talbum = albums[i];\n\t\t\t\tpermission = '' + album.permissions;\n\t\t\t\tthis.albummap[ '' + album.id ] = permission;\n\t\t\t\talbum = [ album.id, album.name, privs[ privmap[permission] || '0' ], icons[permission || '0'] ];\n\t\t\t\toptions[ +album['default'] ? 'unshift' : 'push' ]( album );\n\t\t\t}\n\n\t\t\tthis.select = new SelectWidget({ options: options });\n\n\t\t\tvar div = $('<div class=\"joms-postbox-select-album joms-select\">').insertAfter( this.$form );\n\t\t\tthis.assign( div, this.select );\n\t\t},\n\n\t\tvalue: function() {\n\t\t\tvar album_id,\n\t\t\t\tprivacy;\n\n\t\t\tif ( this.select ) {\n\t\t\t\talbum_id = '' + this.select.value();\n\t\t\t\tprivacy = this.albummap[ album_id ];\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tid: this.pics || [],\n\t\t\t\talbum_id: album_id,\n\t\t\t\tprivacy: privacy\n\t\t\t};\n\t\t},\n\n\t\tupdateProgress: function( file ) {\n\t\t\tvar id = this.getFileId( file ),\n\t\t\t\telem = this.$list.find( '#'+ id ).find('.joms-postbox-photo-progress'),\n\t\t\t\tpercent;\n\n\t\t\tif ( elem && elem.length ) {\n\t\t\t\tpercent = Math.min( 100, Math.floor( file.loaded / file.size * 100 ) );\n\t\t\t\telem.stop().animate({ width: percent + '%' });\n\t\t\t}\n\t\t},\n\n\t\tsetImage: function( file, json ) {\n\t\t\tjson || (json = {});\n\n\t\t\tvar elem = this.$list.find( '#' + this.getFileId(file) ),\n\t\t\t\tsrc = constants.get('juri.base') + json.thumbnail,\n\t\t\t\tid = json.id;\n\n\t\t\telem.find('img').attr( 'src', src ).data( 'id', id );\n\t\t\telem.find('img').attr( 'style', 'visibility:visible');\n\t\t\telem.find('.joms-postbox-photo-action').show();\n\t\t\telem.addClass('joms-postbox-photo-loaded');\n\t\t\telem.find('.joms-postbox-photo-progressbar').remove();\n\n\t\t\tthis.pics || (this.pics = []);\n\t\t\tthis.pics.push( '' + id );\n\n\t\t\tthis.trigger( 'update', this.pics.length );\n\t\t},\n\n\t\tremoveFailed: function() {\n\t\t\tthis.$list.find('.joms-postbox-photo-item')\n\t\t\t\t.not('.joms-postbox-photo-loaded')\n\t\t\t\t.remove();\n\n\t\t\tthis.trigger( 'update', this.pics && this.pics.length || 0 );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Thumbnail event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonRemove: function( e ) {\n\t\t\tvar li = $( e.target ).closest('li'),\n\t\t\t\tid = li.find('img').data('id'),\n\t\t\t\tnum;\n\n\t\t\tli.remove();\n\t\t\tthis.pics = $.without( this.pics, '' + id );\n\t\t\tnum = this.pics.length;\n\n\t\t\tif ( num <= 0 )\n\t\t\t\tthis.select.remove();\n\n\t\t\tthis.ajaxRemove([ id ]);\n\t\t\tthis.trigger( 'update', num );\n\t\t},\n\n\t\tremove: function() {\n\t\t\tthis.pics && this.pics.length && this.ajaxRemove( this.pics );\n\t\t\treturn BaseView.prototype.remove.apply( this, arguments );\n\t\t},\n\n\t\tajaxRemove: function( pics ) {\n\t\t\tvar params = {};\n\t\t\tparams.option = 'community';\n\t\t\tparams.no_html = 1;\n\t\t\tparams.task = 'azrul_ajax';\n\t\t\tparams.func = 'system,ajaxDeleteTempImage';\n\t\t\tparams[ window.jax_token_var ] = 1;\n\n\t\t\tif ( pics && pics.length )\n\t\t\t\tparams[ 'arg2[]' ] = pics;\n\n\t\t\t$.ajax({\n\t\t\t\turl: window.jax_live_site,\n\t\t\t\ttype: 'post',\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: params\n\t\t\t});\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Helper functions.\n\t\t// ---------------------------------------------------------------------\n\n\t\tgetFileId: function( file ) {\n\t\t\treturn 'postbox-preview-' + file.id;\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/inputbox/photo\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/inputbox/photo',[\n\t'sandbox',\n\t'views/inputbox/status',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction( $, InputboxView, language ) {\n\n\treturn InputboxView.extend({\n\n\t\ttemplate: joms.jst[ 'html/inputbox/photo' ],\n\n\t\tinitialize: function() {\n\t\t\tInputboxView.prototype.initialize.apply( this, arguments );\n\t\t\tthis.hint = {\n\t\t\t\tsingle: language.get('status.photo_hint') || '',\n\t\t\t\tmultiple: language.get('status.photos_hint') || ''\n\t\t\t};\n\t\t},\n\n\t\treset: function() {\n\t\t\tInputboxView.prototype.reset.apply( this, arguments );\n\t\t\tthis.single();\n\t\t},\n\n\t\tsingle: function() {\n\t\t\tthis.$textarea.attr( 'placeholder', this.hint.single );\n\t\t},\n\n\t\tmultiple: function() {\n\t\t\tthis.$textarea.attr( 'placeholder', this.hint.multiple );\n\t\t},\n\n\t\tgetTemplate: function() {\n\t\t\tvar html = this.template({ placeholder: this.hint.single });\n\t\t\treturn $( html );\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// utils/uploader\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('utils/uploader',[\n\t'sandbox',\n\t'app'\n],\n\n// definition\n// ----------\nfunction( $, App ) {\n\n\tvar defaults = {\n\t\truntimes: 'html5,html4',\n\t\turl: 'index.php'\n\t};\n\n\tfunction Uploader( options ) {\n\t\tthis.queue = [];\n\t\tthis.ready = false;\n\n\t\tif ( window.plupload ) {\n\t\t\tthis.ready = true;\n\t\t\tthis.create( options );\n\t\t\treturn;\n\t\t}\n\n\t\tvar that = this;\n\t\t$LAB.script( App.legacyUrl + 'multiupload_js/plupload.js' ).wait(function() {\n\t\t\tthat.ready = true;\n\t\t\tthat.create( options );\n\t\t\tthat.execQueue();\n\t\t});\n\t}\n\n\tUploader.prototype.create = function( options ) {\n\t\tvar btn = this.$button = options.browse_button,\n\t\t\tid = false;\n\n\t\tif ( typeof btn === 'string' ) {\n\t\t\tthis.$button = $( document.getElementById(btn) );\n\t\t} else if ( id = btn.attr('id') ) {\n\t\t\tthis.$button = $( document.getElementById(id) );\n\t\t} else {\n\t\t\toptions.browse_button = id = $.uniqueId('uploader_');\n\t\t\tbtn.attr( 'id', id );\n\t\t}\n\n\t\tthis.onProgress = options.onProgress || $.noop;\n\t\tthis.onAdded = options.onAdded || $.noop;\n\n\t\toptions = $.extend({}, defaults, options || {});\n\t\tthis.uploader = new plupload.Uploader( options );\n\t};\n\n\tUploader.prototype.init = function() {\n\t\tif ( !this.ready ) {\n\t\t\tthis.queue.push([ 'init', this, arguments ]);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.uploader.init();\n\t\tthis.uploader.bind( 'FilesAdded', this.onAdded );\n\t\tthis.uploader.bind( 'Error', this.onError );\n\t\tthis.uploader.bind( 'BeforeUpload', this.onBeforeUpload );\n\t\tthis.uploader.bind( 'UploadProgress', this.onProgress );\n\t\tthis.uploader.bind( 'FileUploaded', this.onUploaded );\n\t\tthis.uploader.bind( 'UploadComplete', this.onComplete );\n\t};\n\n\tUploader.prototype.open = function() {\n\t\tif ( !this.ready ) {\n\t\t\tthis.queue.push([ 'open', this, arguments ]);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$button.click();\n\t};\n\n\tUploader.prototype.reset = function() {\n\t\tif ( !this.ready ) {\n\t\t\tthis.queue.push([ 'reset', this, arguments ]);\n\t\t\treturn;\n\t\t}\n\t};\n\n\tUploader.prototype.remove = function() {\n\t\tif ( !this.ready ) {\n\t\t\tthis.queue.push([ 'remove', this, arguments ]);\n\t\t\treturn;\n\t\t}\n\t};\n\n\tUploader.prototype.params = function( data ) {\n\t\tthis.uploader.settings.multipart_params = data;\n\t};\n\n\tUploader.prototype.upload = function() {\n\t\tif ( !this.ready ) {\n\t\t\tthis.queue.push([ 'upload', this, arguments ]);\n\t\t\treturn;\n\t\t}\n\t};\n\n\tUploader.prototype.execQueue = function() {\n\t\tvar cmd;\n\t\twhile ( this.queue.length ) {\n\t\t\tcmd = this.queue.shift();\n\t\t\tthis[ cmd[0] ].apply( cmd[1], cmd[2] );\n\t\t}\n\t};\n\n\t// -------------------------------------------------------------------------\n\n\tUploader.prototype.onAdded = $.noop;\n\tUploader.prototype.onError = $.noop;\n\tUploader.prototype.onBeforeUpload = $.noop;\n\tUploader.prototype.onProgress = $.noop;\n\tUploader.prototype.onUploaded = $.noop;\n\tUploader.prototype.onComplete = $.noop;\n\n\treturn Uploader;\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/postbox/photo\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/postbox/photo',[\n\t'sandbox',\n\t'app',\n\t'views/postbox/default',\n\t'views/postbox/photo-preview',\n\t'views/inputbox/photo',\n\t'views/widget/select',\n\t'utils/constants',\n\t'utils/language',\n\t'utils/uploader'\n],\n\n// definition\n// ----------\nfunction(\n\t$,\n\tApp,\n\tDefaultView,\n\tPreviewView,\n\tInputboxView,\n\tSelectWidget,\n\tconstants,\n\tlanguage,\n\tUploader\n) {\n\n\treturn DefaultView.extend({\n\n\t\ttemplate: joms.jst[ 'html/postbox/photo' ],\n\n\t\tevents: $.extend({}, DefaultView.prototype.events, {\n\t\t\t'click .joms-postbox-photo-upload': 'onPhotoAdd',\n\t\t\t'click li[data-tab=upload]': 'onPhotoAdd'\n\t\t}),\n\n\t\trender: function() {\n\t\t\tDefaultView.prototype.render.apply( this );\n\n\t\t\tthis.$initial = this.$('.joms-postbox-inner-panel');\n\t\t\tthis.$main = this.$('.joms-postbox-photo');\n\n\t\t\tthis.$inputbox = this.$('.joms-postbox-inputbox');\n\t\t\tthis.$preview = this.$('.joms-postbox-preview');\n\t\t\tthis.$tabupload = this.$('[data-tab=upload]');\n\n\t\t\tthis.$uploader = this.$('#joms-postbox-photo-upload');\n\t\t\tthis.$uploaderParent = this.$uploader.parent();\n\n\t\t\t// inputbox\n\t\t\tthis.inputbox = new InputboxView({ charcount: true });\n\t\t\tthis.assign( this.$inputbox, this.inputbox );\n\t\t\tthis.listenTo( this.inputbox, 'focus', this.onInputFocus );\n\n\t\t\t// initialize uploader\n\t\t\tvar url = 'index.php?option=com_community&view=photos&task=ajaxPreview',\n\t\t\t\tsettings = constants.get('settings') || {};\n\n\t\t\tif ( settings.isGroup )\n\t\t\t\turl += '&no_html=1&tmpl=component&groupid=' + ( constants.get('groupid') || '' );\n\n\t\t\tif ( $.ie ) {\n\t\t\t\tthis.$uploader.appendTo( document.body );\n\t\t\t\tthis.$uploader.show();\n\t\t\t}\n\n\t\t\tvar upConfig = {\n\t\t\t\tcontainer: 'joms-postbox-photo-upload',\n\t\t\t\tbrowse_button: 'joms-postbox-photo-upload-btn',\n\t\t\t\turl: url,\n\t\t\t\tfilters: [{ title: 'Image files', extensions: 'jpg,jpeg,png,gif' }]\n\t\t\t};\n\n\t\t\t// resizing on mobile cause errors on android stock browser!\n\t\t\tif ( !$.mobile )\n\t\t\t\tupConfig.resize = { width: 2100, height: 2100, quality: 90 };\n\n\t\t\tthis.uploader = new Uploader( upConfig );\n\t\t\tthis.uploader.onAdded = $.bind( this.onPhotoAdded, this );\n\t\t\tthis.uploader.onError = $.bind( this.onPhotoError, this );\n\t\t\tthis.uploader.onProgress = $.bind( this.onPhotoProgress, this );\n\t\t\tthis.uploader.onUploaded = $.bind( this.onPhotoUploaded, this );\n\t\t\tthis.uploader.init();\n\n\t\t\tif ( $.ie ) {\n\t\t\t\tthis.$uploader.hide();\n\t\t\t\tthis.$uploader.appendTo( this.$uploaderParent );\n\t\t\t}\n\n\t\t\treturn this;\n\t\t},\n\n\t\tshowInitialState: function() {\n\t\t\tthis.$main.hide();\n\t\t\tthis.$initial.show();\n\t\t\t$.ie && ($.ieVersion < 10) && this.ieUploadButtonFix( true );\n\t\t\tthis.inputbox && this.inputbox.single();\n\t\t\tthis.preview && this.preview.remove();\n\t\t\tthis.preview = false;\n\t\t\tDefaultView.prototype.showInitialState.apply( this );\n\t\t},\n\n\t\tshowMainState: function() {\n\t\t\tDefaultView.prototype.showMainState.apply( this );\n\t\t\tthis.$action.hide();\n\t\t\tthis.$initial.hide();\n\t\t\tthis.$main.show();\n\t\t\tthis.$save.show();\n\t\t\t$.ie && ($.ieVersion < 10) && this.ieUploadButtonFix();\n\n\t\t\tif ( App.postbox && App.postbox.value && App.postbox.value.length )\n\t\t\t\tthis.inputbox.set( App.postbox.value[0] );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Data validation and retrieval.\n\t\t// ---------------------------------------------------------------------\n\n\t\treset: function() {\n\t\t\tDefaultView.prototype.reset.apply( this );\n\t\t\tthis.inputbox && this.inputbox.reset();\n\t\t\tthis.preview && this.preview.remove();\n\t\t\tthis.preview = false;\n\t\t},\n\n\t\tvalue: function() {\n\t\t\tthis.data.text = this.inputbox.value() || '';\n\t\t\tthis.data.attachment = {};\n\n\t\t\tif ( this.preview )\n\t\t\t\t$.extend( this.data.attachment, this.preview.value() );\n\n\t\t\treturn DefaultView.prototype.value.apply( this, arguments );\n\t\t},\n\n\t\tvalidate: function() {\n\t\t\tvar value = this.value( true ),\n\t\t\t\tattachment = value[1] || {};\n\n\t\t\tif ( !attachment.id && attachment.id.length )\n\t\t\t\treturn 'No image selected.';\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Photo preview event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonPhotoAdd: function() {\n\t\t\tif ( this.uploading )\n\t\t\t\treturn;\n\n\t\t\tvar conf = constants.get('conf') || {},\n\t\t\t\tlimit = +conf.limitphoto,\n\t\t\t\tuploaded = +conf.uploadedphoto;\n\n\t\t\t// max 8 images for 1 batch upload\n\t\t\tif ( this.preview && this.preview.pics && this.preview.pics.length >= 8 ) {\n\t\t\t\twindow.alert( 'You have reached maximum 8 images for 1 batch upload.' );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// daily limit checking\n\t\t\tif ( this.preview && this.preview.pics && this.preview.pics.length )\n\t\t\t\tuploaded += this.preview.pics.length;\n\n\t\t\tif ( uploaded >= limit ) {\n\t\t\t\twindow.alert( language.get('photo.upload_limit_exceeded') || 'You have reached the upload limit.' );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( $.ie && $.ieVersion === 10 )\n\t\t\t\tthis.$('#joms-postbox-photo-upload').find('input[type=file]').click();\n\t\t\telse\n\t\t\t\tthis.uploader.open();\n\t\t},\n\n\t\tonPhotoAdded: function( up, files ) {\n\t\t\tif ( this.uploading )\n\t\t\t\treturn;\n\n\t\t\tif ( !(files && files.length) )\n\t\t\t\treturn;\n\n\t\t\t// max 8 images for 1 batch upload\n\t\t\tvar curr = 0;\n\t\t\tif ( this.preview && this.preview.pics && this.preview.pics.length )\n\t\t\t\tcurr = this.preview.pics.length;\n\n\t\t\tif ( curr + files.length > 8 ) {\n\t\t\t\tcurr = curr + files.length - 8;\n\t\t\t\tfiles.splice( 0 - curr, curr );\n\t\t\t\tup.splice( 0 - curr, curr );\n\t\t\t}\n\n\t\t\t// daily limit checking\n\t\t\tvar conf = constants.get('conf') || {},\n\t\t\t\tlimit = +conf.limitphoto,\n\t\t\t\tuploaded = +conf.uploadedphoto;\n\n\t\t\tif ( this.preview && this.preview.pics && this.preview.pics.length )\n\t\t\t\tuploaded += this.preview.pics.length;\n\n\t\t\tvar removed;\n\t\t\tif ( uploaded + files.length > limit ) {\n\t\t\t\tremoved = uploaded + files.length - limit;\n\t\t\t\tfiles.splice( 0 - removed, removed );\n\t\t\t\tup.splice( 0 - removed, removed );\n\t\t\t}\n\n\t\t\tvar div;\n\t\t\tif ( !this.preview ) {\n\t\t\t\tdiv = $('<div>').appendTo( this.$preview );\n\t\t\t\tthis.preview = new PreviewView();\n\t\t\t\tthis.assign( div, this.preview );\n\t\t\t\tthis.listenTo( this.preview, 'update', function( num ) {\n\t\t\t\t\tif ( !num || num <= 0 ) {\n\t\t\t\t\t\tthis.showInitialState();\n\t\t\t\t\t\tthis.inputbox.single();\n\t\t\t\t\t\tthis.uploading = 0;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.inputbox[ num > 1 ? 'multiple' : 'single' ]();\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tthis.showMainState();\n\t\t\tfor ( var i = 0; i < files.length; i++ )\n\t\t\t\tthis.preview.add( files[i] );\n\n\t\t\tthis.uploading = files.length;\n\t\t\tthis.$action.hide();\n\n\t\t\tup.start();\n\t\t\tup.refresh();\n\t\t},\n\n\t\tonPhotoError: function( up, file ) {\n\t\t\tif ( +file.code === +plupload.FILE_EXTENSION_ERROR ) {\n\t\t\t\twindow.alert( 'Selected file type is not permitted.' );\n\t\t\t}\n\t\t},\n\n\t\tonPhotoProgress: function( up, file ) {\n\t\t\tthis.preview.updateProgress( file );\n\t\t},\n\n\t\tonPhotoUploaded: function( up, file, info ) {\n\t\t\tvar json;\n\t\t\ttry {\n\t\t\t\tjson = JSON.parse( info.response );\n\t\t\t} catch ( e ) {}\n\n\t\t\tjson || (json = {});\n\n\t\t\t// onerror\n\t\t\tif ( !json.thumbnail ) {\n\t\t\t\tup.stop();\n\t\t\t\tup.splice();\n\t\t\t\twindow.alert( json && json.msg || 'Undefined error.' );\n\t\t\t\tthis.uploading = 0;\n\t\t\t\tthis.$action.show();\n\t\t\t\tthis.preview && this.preview.removeFailed();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.uploading--;\n\t\t\tif ( this.uploading <= 0 )\n\t\t\t\tthis.$action.show();\n\n\t\t\tif ( this.preview )\n\t\t\t\tthis.preview.setImage( file, json );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Helper functions.\n\t\t// ---------------------------------------------------------------------\n\n\t\tgetTemplate: function() {\n\t\t\tvar html = this.template({\n\t\t\t\tjuri: constants.get('juri'),\n\t\t\t\tlanguage: {\n\t\t\t\t\tpostbox: language.get('postbox') || {},\n\t\t\t\t\tphoto: language.get('photo') || {}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn $( html ).hide();\n\t\t},\n\n\t\tgetStaticAttachment: function() {\n\t\t\tif ( this.staticAttachment )\n\t\t\t\treturn this.staticAttachment;\n\n\t\t\tthis.staticAttachment = $.extend({},\n\t\t\t\tconstants.get('postbox.attachment') || {},\n\t\t\t\t{ type: 'photo' }\n\t\t\t);\n\n\t\t\treturn this.staticAttachment;\n\t\t},\n\n\t\tieUploadButtonFix: function( initialState ) {\n\t\t\tif ( !this.ieUploadButtonFix.init ) {\n\t\t\t\tthis.ieUploadButtonFix.init = true;\n\t\t\t\tthis.$uploader.css({\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\topacity: 0,\n\t\t\t\t\twidth: '',\n\t\t\t\t\theight: ''\n\t\t\t\t}).children('button,form').css({\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\twidth: '',\n\t\t\t\t\theight: '',\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tright: 0,\n\t\t\t\t\tbottom: 0,\n\t\t\t\t\tleft: 0\n\t\t\t\t}).children('input').css({\n\t\t\t\t\tcursor: 'pointer',\n\t\t\t\t\theight: '100%'\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif ( initialState ) {\n\t\t\t\tthis.$uploader.appendTo( this.$uploaderParent );\n\t\t\t\tthis.$uploader.css({\n\t\t\t\t\ttop: 12,\n\t\t\t\t\tright: 12,\n\t\t\t\t\tbottom: 12,\n\t\t\t\t\tleft: 12\n\t\t\t\t}).children('form').css({\n\t\t\t\t\twidth: '100%',\n\t\t\t\t\theight: '100%'\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.$uploader.appendTo( this.$tabupload );\n\t\t\t\tthis.$uploader.css({\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tright: 0,\n\t\t\t\t\tbottom: 0,\n\t\t\t\t\tleft: 0\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/inputbox/videourl\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/inputbox/videourl',[\n\t'sandbox',\n\t'views/inputbox/base',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction( $, InputboxView, language ) {\n\n\treturn InputboxView.extend({\n\n\t\ttemplate: joms.jst[ 'html/inputbox/videourl' ],\n\n\t\trender: function() {\n\t\t\tvar div = this.getTemplate();\n\t\t\tthis.$el.replaceWith( div );\n\t\t\tthis.setElement( div );\n\t\t\tInputboxView.prototype.render.apply( this, arguments );\n\t\t},\n\n\t\tonKeydown: function( e ) {\n\t\t\tif ( e && e.keyCode === 13 )\n\t\t\t\te.preventDefault();\n\n\t\t\tvar that = this;\n\t\t\t$.defer(function() {\n\t\t\t\tthat.updateInput( e );\n\t\t\t});\n\t\t},\n\n\t\tgetTemplate: function() {\n\t\t\tvar hint = language.get('video.link_hint') || '',\n\t\t\t\thtml = this.template({ placeholder: hint });\n\n\t\t\treturn $( html );\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/postbox/fetcher-video\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/postbox/fetcher-video',[\n\t'sandbox',\n\t'views/base',\n\t'views/widget/select',\n\t'utils/ajax',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction( $, BaseView, SelectWidget, ajax, language ) {\n\n\treturn BaseView.extend({\n\n\t\ttemplate: joms.jst[ 'html/postbox/fetcher-video' ],\n\n\t\tevents: {\n\t\t\t'click .joms-fetched-close': 'onClose',\n\t\t\t'click .joms-fetched-field span': 'onFocus',\n\t\t\t'keyup .joms-fetched-field input': 'onKeyup',\n\t\t\t'keyup .joms-fetched-field textarea': 'onKeyup',\n\t\t\t'blur .joms-fetched-field input': 'onBlur',\n\t\t\t'blur .joms-fetched-field textarea': 'onBlur'\n\t\t},\n\n\t\tinitialize: function() {\n\t\t\tvar lang = language.get('fetch') || {};\n\t\t\tthis.titlePlaceholder = lang.title_hint || '';\n\t\t\tthis.descPlaceholder = lang.description_hint || '';\n\t\t\tlang = language.get('video');\n\t\t\tthis.categoryLabel = lang.category_label;\n\t\t},\n\n\t\tfetch: function( text ) {\n\t\t\tvar rUrl = /^(|.*\\s)(https?:\\/\\/|www\\.)([a-z0-9-]+\\.)+[a-z]{2,4}(:\\d+)?(\\/.*)?(\\s.*|)$/i,\n\t\t\t\tisFetchable = text.match( rUrl );\n\n\t\t\tif ( this.fetching || !isFetchable )\n\t\t\t\treturn;\n\n\t\t\tthis.id = false;\n\t\t\tthis.url = text;\n\t\t\tthis.fetching = true;\n\t\t\tthis.fetched = false;\n\n\t\t\tthis.trigger('fetch:start');\n\n\t\t\t// TODO video limit...\n\n\t\t\tvar that = this;\n\t\t\tajax({\n\t\t\t\tfn: 'videos,ajaxLinkVideoPreview',\n\t\t\t\tdata: [ text ],\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tthat.fetching = false;\n\t\t\t\t\tthat.trigger('fetch:done');\n\t\t\t\t},\n\t\t\t\tsuccess: $.bind( this.render, this )\n\t\t\t});\n\t\t},\n\n\t\trender: function( resp ) {\n\t\t\tresp = this.parseResponse( resp );\n\t\t\tif ( !resp ) {\n\t\t\t\tthis.trigger( 'fetch:failed' );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar video = resp && resp.video,\n\t\t\t\tcategories = resp && resp.category || [];\n\n\t\t\tif ( !(video && video.id) ) {\n\t\t\t\tthis.trigger( 'fetch:failed', resp );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.video_id = video.id;\n\t\t\tthis.fetched = true;\n\n\t\t\tvar data = {\n\t\t\t\ttitle: video.title || '',\n\t\t\t\ttitlePlaceholder: this.titlePlaceholder,\n\t\t\t\tdescription: video.description || '',\n\t\t\t\tdescPlaceholder: this.descPlaceholder,\n\t\t\t\timage: video.thumb || false\n\t\t\t};\n\n\t\t\tthis.select && this.select.remove();\n\t\t\tthis.$el.html( this.template( data ) );\n\t\t\tthis.$image = this.$('.joms-fetched-images').find('img');\n\t\t\tthis.$title = this.$('.joms-fetched-title').find('input');\n\t\t\tthis.$description = this.$('.joms-fetched-description').find('textarea');\n\t\t\tthis.$category = this.$('.joms-fetched-category');\n\n\t\t\tvar options = [];\n\t\t\tfor ( var i = 0; i < categories.length; i++ ) {\n\t\t\t\toptions.push([ categories[i].id, this.categoryLabel + ': ' + categories[i].name ]);\n\t\t\t}\n\n\t\t\tthis.select = new SelectWidget({ options: options });\n\t\t\tthis.assign( this.$category, this.select );\n\n\t\t\treturn this;\n\t\t},\n\n\t\tchange: function( el ) {\n\t\t\tvar input = $( el ),\n\t\t\t\tspan = input.prev('span'),\n\t\t\t\tval = input.val().replace( /^\\s+|\\s+$/g, '' );\n\n\t\t\tif ( !val ) {\n\t\t\t\tif ( input.parent().hasClass('joms-fetched-title') )\n\t\t\t\t\tval = this.titlePlaceholder;\n\t\t\t\telse\n\t\t\t\t\tval = this.descPlaceholder;\n\t\t\t}\n\n\t\t\tinput.hide();\n\t\t\tspan.text( val ).show();\n\t\t},\n\n\t\tremove: function() {\n\t\t\tBaseView.prototype.remove.apply( this );\n\t\t\tthis.trigger('remove');\n\t\t},\n\n\t\tvalue: function() {\n\t\t\tif ( this.fetching )\n\t\t\t\treturn [];\n\n\t\t\treturn [\n\t\t\t\tthis.video_id,\n\t\t\t\tthis.url,\n\t\t\t\tthis.$image && this.$image.attr('src'),\n\t\t\t\tthis.$title && this.$title.val().replace( /\\t/g, '\\\\t' ).replace( /\\n/g, '\\\\n' ),\n\t\t\t\tthis.$description && this.$description.val().replace( /\\t/g, '\\\\t' ).replace( /\\n/g, '\\\\n' ),\n\t\t\t\tthis.select && this.select.value()\n\t\t\t];\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonClose: function() {\n\t\t\tthis.remove();\n\t\t},\n\n\t\tonFocus: function( e ) {\n\t\t\tvar span = $( e.currentTarget ),\n\t\t\t\tinput = span.next('input,textarea');\n\n\t\t\tspan.hide();\n\t\t\tinput.show();\n\t\t\tsetTimeout(function() {\n\t\t\t\tinput[0].focus();\n\t\t\t}, 300 );\n\t\t},\n\n\t\tonKeyup: function( e ) {\n\t\t\tif ( e.keyCode === 13 ) {\n\t\t\t\tthis.change( e.currentTarget );\n\t\t\t}\n\t\t},\n\n\t\tonBlur: function( e ) {\n\t\t\tthis.change( e.currentTarget );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Ajax response parser.\n\t\t// ---------------------------------------------------------------------\n\n\t\tparseResponse: function( resp ) {\n\t\t\tvar json;\n\n\t\t\tif ( resp && resp.length ) {\n\t\t\t\tfor ( var i = 0; i < resp.length; i++ ) {\n\t\t\t\t\tif ( resp[i][1] === '__throwError' ) {\n\t\t\t\t\t\tjson = { msg: resp[i][3] };\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else if ( resp[i][1] === '__callback' ) {\n\t\t\t\t\t\tjson = resp[i][3][0];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn json;\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/inputbox/video\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/inputbox/video',[\n\t'sandbox',\n\t'views/inputbox/status',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction( $, InputboxView, language ) {\n\n\treturn InputboxView.extend({\n\n\t\ttemplate: joms.jst[ 'html/inputbox/video' ],\n\n\t\tgetTemplate: function() {\n\t\t\tvar hint = language.get('status.video_hint') || '',\n\t\t\t\thtml = this.template({ placeholder: hint });\n\n\t\t\treturn $( html );\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/postbox/video\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/postbox/video',[\n\t'sandbox',\n\t'app',\n\t'views/postbox/default',\n\t'views/inputbox/videourl',\n\t'views/postbox/fetcher-video',\n\t'views/inputbox/video',\n\t'views/dropdown/location',\n\t'views/dropdown/privacy',\n\t'views/widget/select',\n\t'utils/ajax',\n\t'utils/constants',\n\t'utils/language',\n\t'utils/uploader'\n],\n\n// definition\n// ----------\nfunction(\n\t$,\n\tApp,\n\tDefaultView,\n\tUrlView,\n\tFetcherView,\n\tInputboxView,\n\tLocationView,\n\tPrivacyView,\n\tSelectWidget,\n\tajax,\n\tconstants,\n\tlanguage,\n\tUploader\n) {\n\n\treturn DefaultView.extend({\n\n\t\tsubviews: {\n\t\t\tlocation: LocationView,\n\t\t\tprivacy: PrivacyView\n\t\t},\n\n\t\ttemplate: joms.jst[ 'html/postbox/video' ],\n\n\t\tevents: $.extend({}, DefaultView.prototype.events, {\n\t\t\t'click [data-action=share]': 'onVideoUrl',\n\t\t\t'click [data-action=upload]': 'onVideoUpload'\n\t\t}),\n\n\t\tinitialize: function() {\n\t\t\tthis.enableUpload = +constants.get('conf.enablevideosupload');\n\t\t\tthis.enableLocation = +constants.get('conf.enablevideosmap');\n\n\t\t\tvar settings = constants.get('settings') || {};\n\t\t\tif ( this.inheritPrivacy = (settings.isGroup || settings.isEvent || !settings.isMyProfile))\n\t\t\t\tthis.subviews = $.omit( this.subviews, 'privacy' );\n\n\t\t\tthis.language = {\n\t\t\t\tpostbox: language.get('postbox'),\n\t\t\t\tstatus: language.get('status'),\n\t\t\t\tvideo: language.get('video')\n\t\t\t};\n\n\t\t\tDefaultView.prototype.initialize.apply( this );\n\t\t},\n\n\t\trender: function() {\n\t\t\tDefaultView.prototype.render.apply( this );\n\n\t\t\tthis.$initial = this.$('.joms-initial-panel');\n\t\t\tthis.$main = this.$('.joms-postbox-video');\n\t\t\tthis.$stateurl = this.$('.joms-postbox-video-state-url');\n\t\t\tthis.$stateupload = this.$('.joms-postbox-video-state-upload');\n\n\t\t\tthis.$url = this.$stateurl.find('.joms-postbox-url');\n\t\t\tthis.$fetcher = this.$stateurl.find('.joms-postbox-fetched');\n\t\t\tthis.$file = this.$stateupload.find('.joms-postbox-url');\n\t\t\tthis.$fileprogress = this.$stateupload.find('.joms-postbox-photo-progress');\n\n\t\t\tthis.$inputbox = this.$('.joms-postbox-inputbox');\n\t\t\tthis.$tabupload = this.$tabs.find('[data-tab=upload]');\n\t\t\tthis.$tablocation = this.$tabs.find('[data-tab=location]');\n\t\t\tthis.$tabprivacy = this.$tabs.find('[data-tab=privacy]');\n\n\t\t\tif ( this.inheritPrivacy )\n\t\t\t\tthis.$tabprivacy.css({ visibility: 'hidden' });\n\n\t\t\t// url\n\t\t\tthis.url = new UrlView();\n\t\t\tthis.assign( this.$url, this.url );\n\t\t\tthis.listenTo( this.url, 'focus', this.onUrlFocus );\n\t\t\tthis.listenTo( this.url, 'keydown', this.onUrlUpdate );\n\t\t\tthis.listenTo( this.url, 'blur', this.onUrlUpdate );\n\n\t\t\t// inputbox\n\t\t\tthis.inputbox = new InputboxView({ attachment: true, charcount: true });\n\t\t\tthis.assign( this.$inputbox, this.inputbox );\n\t\t\tthis.listenTo( this.inputbox, 'focus', this.onInputFocus );\n\n\t\t\t// init privacy\n\t\t\tvar defaultPrivacy, settings;\n\t\t\tif ( !this.inheritPrivacy ) {\n\t\t\t\tsettings = constants.get('settings') || {};\n\t\t\t\tif ( settings.isProfile && settings.isMyProfile )\n\t\t\t\t\tdefaultPrivacy = constants.get('conf.profiledefaultprivacy');\n\t\t\t\tthis.initSubview('privacy', { defaultPrivacy: defaultPrivacy || 'public' });\n\t\t\t}\n\n\t\t\tvar maxFileSize = +constants.get('conf.maxvideouploadsize') || 0;\n\t\t\tif ( maxFileSize ) {\n\t\t\t\tmaxFileSize += 'mb';\n\t\t\t}\n\n\t\t\t// initialize uploader\n\t\t\tthis.uploader = new Uploader({\n\t\t\t\tcontainer: 'joms-postbox-video-upload',\n\t\t\t\tbrowse_button: 'joms-postbox-video-upload-btn',\n\t\t\t\turl: 'index.php?option=com_community&view=videos&task=uploadvideo',\n\t\t\t\tmulti_selection: false,\n\t\t\t\tfilters: [{ title: 'Video files', extensions: '3g2,3gp,asf,asx,avi,flv,mov,mp4,mpg,rm,swf,vob,wmv,m4v' }],\n\t\t\t\tmax_file_size: maxFileSize\n\t\t\t});\n\n\t\t\t// uploader events\n\t\t\tthis.uploader.onAdded = $.bind( this.onVideoAdded, this );\n\t\t\tthis.uploader.onError = $.bind( this.onVideoError, this );\n\t\t\tthis.uploader.onBeforeUpload = $.bind( this.onVideoBeforeUpload, this );\n\t\t\tthis.uploader.onProgress = $.bind( this.onVideoProgress, this );\n\t\t\tthis.uploader.onUploaded = $.bind( this.onVideoUploaded, this );\n\t\t\tthis.uploader.init();\n\n\t\t\treturn this;\n\t\t},\n\n\t\tshowInitialState: function() {\n\t\t\tthis.reset();\n\t\t\tthis.$tabs.hide();\n\t\t\tthis.$action.hide();\n\t\t\tthis.$save.hide();\n\n\t\t\tif ( this.enableUpload ) {\n\t\t\t\tthis.$main.hide();\n\t\t\t\tthis.$initial.show();\n\t\t\t} else {\n\t\t\t\tthis.showUrlState();\n\t\t\t}\n\n\t\t\tthis.trigger('show:initial');\n\t\t},\n\n\t\tshowMainState: function( upload ) {\n\t\t\tupload ? this.showUploadState() : this.showUrlState();\n\t\t\tthis.$tabs.show();\n\t\t\tthis.$action.show();\n\t\t\tthis.trigger('show:main');\n\t\t},\n\n\t\tshowUrlState: function() {\n\t\t\tthis.inputbox.$el.find('.joms-postbox-input-placeholder').html( this.language.status.video_hint );\n\t\t\tthis.$save.html( this.language.postbox.post_button );\n\t\t\tthis.$stateupload.hide();\n\t\t\tthis.$stateurl.show();\n\t\t\tthis.$tablocation.hide();\n\t\t\tthis.$initial.hide();\n\t\t\tthis.$main.show();\n\t\t\tthis.$save.hide();\n\t\t\tthis.upload = false;\n\n\t\t\tif ( App.postbox && App.postbox.value && App.postbox.value.length )\n\t\t\t\tthis.inputbox.set( App.postbox.value[0] );\n\t\t},\n\n\t\tshowUploadState: function() {\n\t\t\tvar categories, options, i;\n\n\t\t\tif ( !this.uploadcat ) {\n\t\t\t\tcategories = constants.get('videoCategories') || [];\n\t\t\t\toptions = [];\n\t\t\t\tfor ( i = 0; i < categories.length; i++ ) {\n\t\t\t\t\toptions.push([ categories[i].id, this.language.video.category_label + ': ' + categories[i].name ]);\n\t\t\t\t}\n\n\t\t\t\tthis.uploadcat = new SelectWidget({ options: options });\n\t\t\t\tthis.$uploadcat = this.$stateupload.find('.joms-fetched-category');\n\t\t\t\tthis.assign( this.$uploadcat, this.uploadcat );\n\t\t\t}\n\n\t\t\tthis.inputbox.$el.find('.joms-postbox-input-placeholder').html( this.language.video.upload_hint );\n\t\t\tthis.$save.html( this.language.postbox.upload_button );\n\t\t\tthis.$stateurl.hide();\n\t\t\tthis.$stateupload.show();\n\t\t\tthis.$tablocation[ this.enableLocation ? 'show' : 'hide' ]();\n\t\t\tthis.$initial.hide();\n\t\t\tthis.$main.show();\n\t\t\tthis.$save.show();\n\t\t\tthis.upload = true;\n\n\t\t\tif ( App.postbox && App.postbox.value && App.postbox.value.length )\n\t\t\t\tthis.inputbox.set( App.postbox.value[0] );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Data validation and retrieval.\n\t\t// ---------------------------------------------------------------------\n\n\t\treset: function() {\n\t\t\tDefaultView.prototype.reset.apply( this );\n\t\t\tthis.url && this.url.reset();\n\t\t\tthis.inputbox && this.inputbox.reset();\n\t\t\tthis.fetcher && this.fetcher.remove();\n\t\t},\n\n\t\tvalue: function() {\n\t\t\tthis.data.text = this.inputbox.value() || '';\n\t\t\tthis.data.attachment = {};\n\n\t\t\tvar value;\n\t\t\tfor ( var prop in this.subflags )\n\t\t\t\tif ( value = this.subviews[ prop ].value() )\n\t\t\t\t\tthis.data.attachment[ prop ] = value;\n\n\t\t\t// video upload\n\t\t\tif ( this.upload ) {\n\t\t\t\tif ( this.status && this.status.status === 'success' )\n\t\t\t\t\tthis.data.attachment.fetch = [ this.status.videoid ];\n\n\t\t\t// video share\n\t\t\t} else {\n\t\t\t\tif ( this.fetcher )\n\t\t\t\t\tthis.data.attachment.fetch = this.fetcher.value();\n\t\t\t}\n\n\t\t\treturn DefaultView.prototype.value.apply( this, arguments );\n\t\t},\n\n\t\tvalidate: function() {\n\t\t\tvar value = this.value( true ),\n\t\t\t\tattachment = value[1] || {},\n\t\t\t\tfetch = attachment.fetch;\n\n\t\t\t// video upload\n\t\t\tif ( this.upload ) {\n\t\t\t\t// no validation here\n\n\t\t\t// video share\n\t\t\t} else {\n\t\t\t\tif ( !fetch || !fetch.length )\n\t\t\t\t\treturn 'Please share a valid video url.';\n\t\t\t}\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonPost: function() {\n\t\t\tif ( this.saving )\n\t\t\t\treturn;\n\n\t\t\tvar error = this.validate();\n\t\t\tif ( error ) {\n\t\t\t\twindow.alert( error );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.saving = true;\n\t\t\tthis.$loading.show();\n\n\t\t\tif ( this.upload === true ) {\n\t\t\t\tthis.uploader.uploader.start();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar that = this;\n\t\t\tajax({\n\t\t\t\tfn: 'system,ajaxStreamAdd',\n\t\t\t\tdata: this.value(),\n\t\t\t\tsuccess: $.bind( this.onPostSuccess, this ),\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tthat.$loading.hide();\n\t\t\t\t\tthat.saving = false;\n\t\t\t\t\tthat.showInitialState();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Dropdowns event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonLocationSelect: function( location ) {\n\t\t\tthis.inputbox.updateAttachment( null, location );\n\t\t},\n\n\t\tonLocationRemove: function() {\n\t\t\tthis.inputbox.updateAttachment( null, false );\n\t\t},\n\n\t\tonPrivacySelect: function( data ) {\n\t\t\tthis.$tabprivacy.find('i').attr( 'class', 'joms-icon-' + data.icon );\n\t\t\tthis.$tabprivacy.find('span').html( data.label );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Inputbox event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonUrlFocus: function() {\n\t\t\tif ( !this.enableUpload )\n\t\t\t\tthis.showMainState();\n\t\t},\n\n\t\tonUrlUpdate: function( text, key ) {\n\t\t\tvar div;\n\n\t\t\tif ( text )\n\t\t\t\ttext = text.replace( /^\\s+|\\s+$/g, '' );\n\n\t\t\t// triggers fetch content on spacebar and return keys\n\t\t\tif ( key === 32 || key === 13 ) {\n\t\t\t\tif ( this.fetcher && this.fetcher.fetched )\n\t\t\t\t\treturn;\n\n\t\t\t\tdelete this.data.attachment.fetch;\n\n\t\t\t\tdiv = $('<div>').appendTo( this.$fetcher );\n\t\t\t\tthis.fetcher && this.fetcher.remove();\n\t\t\t\tthis.fetcher = new FetcherView();\n\t\t\t\tthis.fetcher.setElement( div );\n\t\t\t\tthis.listenTo( this.fetcher, 'fetch:start', this.onFetchStart );\n\t\t\t\tthis.listenTo( this.fetcher, 'fetch:failed', this.onFetchFailed );\n\t\t\t\tthis.listenTo( this.fetcher, 'fetch:done', this.onFetchDone );\n\t\t\t\tthis.listenTo( this.fetcher, 'remove', this.onFetchRemove );\n\t\t\t\tthis.fetcher.fetch( text );\n\t\t\t}\n\t\t},\n\n\t\tonInputFocus: function() {\n\t\t\tif ( !this.enableUpload )\n\t\t\t\tthis.showMainState();\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Video preview event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonFetchStart: function() {\n\t\t\tthis.saving = true;\n\t\t\tthis.$loading.show();\n\t\t\tthis.$save.hide();\n\t\t},\n\n\t\tonFetchFailed: function( resp ) {\n\t\t\tthis.fetcher && this.fetcher.remove();\n\t\t\tthis.saving = false;\n\t\t\tthis.$loading.hide();\n\t\t\tthis.$save.hide();\n\n\t\t\tvar msg = resp && resp.msg || 'Undefined error.';\n\t\t\twindow.alert( msg );\n\t\t},\n\n\t\tonFetchDone: function() {\n\t\t\tthis.saving = false;\n\t\t\tthis.$loading.hide();\n\t\t\tif ( this.fetcher && this.fetcher.fetched )\n\t\t\t\tthis.$save.show();\n\t\t},\n\n\t\tonFetchRemove: function() {\n\t\t\tthis.fetcher = false;\n\t\t\tthis.$save.hide();\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Video upload event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonVideoUrl: function() {\n\t\t\tthis.showMainState();\n\t\t},\n\n\t\tonVideoUpload: function() {\n\t\t\tvar conf = constants.get('conf') || {},\n\t\t\t\tlimit = +conf.limitvideo,\n\t\t\t\tuploaded = +conf.uploadedvideo;\n\n\t\t\tif ( uploaded >= limit ) {\n\t\t\t\twindow.alert( language.get('video.upload_limit_exceeded') || 'You have reached the upload limit.' );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.uploader.uploader.splice();\n\t\t\tthis.uploader.open();\n\t\t},\n\n\t\tonVideoAdded: function( up, files ) {\n\t\t\tif ( !(files && files.length) )\n\t\t\t\treturn;\n\n\t\t\tvar file = files[0],\n\t\t\t\tname = '<b>' + file.name + '</b>',\n\t\t\t\tsize = file.size || 0,\n\t\t\t\tunit = 'Bytes';\n\n\t\t\tfor ( var units = [ 'KB', 'MB', 'GB' ]; size >= 1000 && units.length; ) {\n\t\t\t\tunit = units.shift();\n\t\t\t\tsize = Math.ceil( size / 1000 );\n\t\t\t}\n\n\t\t\tif ( size )\n\t\t\t\tname += ' (' + size + ' ' + unit + ')';\n\n\t\t\tthis.$file.html( name );\n\t\t\tthis.$fileprogress.css({ width: 0 });\n\t\t\tthis.showMainState('upload');\n\t\t},\n\n\t\tonVideoError: function( up, file ) {\n\t\t\tvar tmp;\n\t\t\tif ( +file.code === +plupload.FILE_SIZE_ERROR ) {\n\t\t\t\ttmp = +constants.get('conf.maxvideouploadsize') || 0;\n\t\t\t\twindow.alert( 'Maximum file size for video upload is ' + tmp + ' MB.' );\n\t\t\t} else if ( +file.code === +plupload.FILE_EXTENSION_ERROR ) {\n\t\t\t\twindow.alert( 'Selected file type is not permitted.' );\n\t\t\t}\n\t\t},\n\n\t\tonVideoBeforeUpload: function() {\n\t\t\tvar params = {\n\t\t\t\tdescription : this.inputbox.value()\n\t\t\t};\n\n\t\t\tif ( this.subflags.privacy )\n\t\t\t\tparams.permissions = this.subviews.privacy.value();\n\n\t\t\tvar location = this.subflags.location && this.subviews.location.value();\n\t\t\tif ( location && location.length )\n\t\t\t\tparams.location = location;\n\n\t\t\tif ( this.uploadcat )\n\t\t\t\tparams.category_id = this.uploadcat && this.uploadcat.value();\n\n\t\t\tthis.uploader.params( params );\n\t\t},\n\n\t\tonVideoProgress: function( up, file ) {\n\t\t\tvar percent = Math.min( 100, Math.round( 100 * file.loaded / file.size ) );\n\t\t\tthis.$fileprogress.animate({ width: percent + '%' });\n\t\t},\n\n\t\tonVideoUploaded: function( up, file, info ) {\n\t\t\tvar json, that;\n\t\t\ttry {\n\t\t\t\tjson = JSON.parse( info.response );\n\t\t\t} catch ( e ) {}\n\n\t\t\tthis.status = json || {};\n\t\t\tthat = this;\n\t\t\tsetTimeout(function() {\n\t\t\t\tthat.$loading.hide();\n\t\t\t\tthat.saving = false;\n\t\t\t\tthat.showInitialState();\n\n\t\t\t\tif ( that.status.status !== 'success' ){\n\t\t\t\t\twindow.alert( that.status.message || 'Undefined error.' );\n\t\t\t\t} else {\n\t\t\t\t\tvar conf = constants.get('conf') || {};\n\t\t\t\t\t++conf.uploadedvideo;\n\t\t\t\t\twindow.alert( that.status.processing_str );\n\t\t\t\t}\n\t\t\t}, 1000 );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Helper functions.\n\t\t// ---------------------------------------------------------------------\n\n\t\tgetTemplate: function() {\n\t\t\tvar html = this.template({\n\t\t\t\tjuri: constants.get('juri'),\n\t\t\t\tenable_upload: this.enableUpload,\n\t\t\t\tvideo_maxsize: constants.get('conf.maxvideouploadsize'),\n\t\t\t\tlanguage: {\n\t\t\t\t\tpostbox: language.get('postbox') || {},\n\t\t\t\t\tvideo: language.get('video') || {}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn $( html ).hide();\n\t\t},\n\n\t\tgetStaticAttachment: function() {\n\t\t\tif ( this.staticAttachment )\n\t\t\t\treturn this.staticAttachment;\n\n\t\t\tthis.staticAttachment = $.extend({},\n\t\t\t\tconstants.get('postbox.attachment') || {},\n\t\t\t\t{ type: 'video' }\n\t\t\t);\n\n\t\t\treturn this.staticAttachment;\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/inputbox/eventtitle\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/inputbox/eventtitle',[\n\t'sandbox',\n\t'views/inputbox/base',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction( $, InputboxView, language ) {\n\n\treturn InputboxView.extend({\n\n\t\ttemplate: joms.jst[ 'html/inputbox/eventtitle' ],\n\n\t\trender: function() {\n\t\t\tvar div = this.getTemplate();\n\t\t\tthis.$el.replaceWith( div );\n\t\t\tthis.setElement( div );\n\t\t\tInputboxView.prototype.render.apply( this, arguments );\n\t\t},\n\n\t\tgetTemplate: function() {\n\t\t\tvar hint = language.get('event.title_hint') || '',\n\t\t\t\thtml = this.template({ placeholder: hint });\n\n\t\t\treturn $( html );\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/inputbox/eventdesc\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/inputbox/eventdesc',[\n\t'sandbox',\n\t'views/inputbox/base',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction( $, InputboxView, language ) {\n\n\treturn InputboxView.extend({\n\n\t\ttemplate: joms.jst[ 'html/inputbox/eventdesc' ],\n\n\t\trender: function() {\n\t\t\tvar div = this.getTemplate();\n\t\t\tthis.$el.replaceWith( div );\n\t\t\tthis.setElement( div );\n\t\t\tInputboxView.prototype.render.apply( this, arguments );\n\t\t},\n\n\t\tgetTemplate: function() {\n\t\t\tvar hint = language.get('status.event_hint') || '',\n\t\t\t\thtml = this.template({ placeholder: hint });\n\n\t\t\treturn $( html );\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// utils/format\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('utils/format',[\n\t'sandbox'\n],\n\n// definition\n// ----------\nfunction( $ ) {\n\n\tfunction pad( str, len, padStr ) {\n\t\tif ( !$.isString( str ) )\n\t\t\treturn str;\n\n\t\tif ( !$.isNumber( len ) || str.length >= len )\n\t\t\treturn str;\n\n\t\tlen = len - str.length;\n\t\tfor ( var i = 0; i < len; i++ )\n\t\t\tstr = ( padStr || ' ' ) + str;\n\n\t\treturn str;\n\t}\n\n\treturn {\n\t\tpad: pad\n\t};\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/dropdown/datepicker\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/dropdown/event',[\n\t'sandbox',\n\t'views/dropdown/base',\n\t'views/widget/select',\n\t'utils/constants',\n\t'utils/language',\n\t'utils/format'\n],\n\n// definition\n// ----------\nfunction( $, BaseView, SelectWidget, constants, language, format ) {\n\n\treturn BaseView.extend({\n\n\t\ttemplate: joms.jst[ 'html/dropdown/event' ],\n\n\t\tevents: {\n\t\t\t'click .joms-event-allday': 'onToggleCheckbox',\n\t\t\t'click .joms-postbox-done': 'onSave'\n\t\t},\n\n\t\tinitialize: function() {\n\t\t\tBaseView.prototype.initialize.apply( this );\n\n\t\t\tvar categories = constants.get('eventCategories') || [],\n\t\t\t\toptions = [];\n\n\t\t\tthis.categoriesMap = {};\n\t\t\tif ( categories && categories.length ) {\n\t\t\t\tfor ( var i = 0, id = categories[i].id, name = categories[i].name; i < categories.length; i++ ) {\n\t\t\t\t\tid = categories[i].id;\n\t\t\t\t\tname = categories[i].name;\n\t\t\t\t\tthis.categoriesMap[ id ] = name;\n\t\t\t\t\toptions.push([ id, name ]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.category = new SelectWidget({ options: options });\n\t\t},\n\n\t\trender: function() {\n\t\t\tvar div = this.getTemplate();\n\n\t\t\tthis.$el.replaceWith( div );\n\t\t\tthis.setElement( div );\n\t\t\tthis.$category = this.$('.joms-event-category');\n\t\t\tthis.$location = this.$('[name=location]').val('');\n\t\t\tthis.$startdate = this.$('.joms-pickadate-startdate').pickadate({ min: new Date(), klass: { frame: 'picker__frame startDate' } });\n\t\t\tthis.$starttime = this.$('.joms-pickadate-starttime').pickatime({ interval: 10, klass: { frame: 'picker__frame startTime' } });\n\t\t\tthis.$enddate = this.$('.joms-pickadate-enddate').pickadate({ klass: { frame: 'picker__frame endDate' } });\n\t\t\tthis.$endtime = this.$('.joms-pickadate-endtime').pickatime({ interval: 10, klass: { frame: 'picker__frame endTime' } });\n\t\t\t// this.$allday = this.$('.joms-event-allday').hide().show();\n\t\t\tthis.$done = this.$('.joms-event-done');\n\n\t\t\tthis.assign( this.$category, this.category );\n\t\t\tthis.startdate = this.$startdate.pickadate('picker');\n\t\t\tthis.starttime = this.$starttime.pickatime('picker');\n\t\t\tthis.enddate = this.$enddate.pickadate('picker');\n\t\t\tthis.endtime = this.$endtime.pickatime('picker');\n\n\t\t\tthis.startdate.on({ set: $.bind( this.onSetStartDate, this ) });\n\t\t\tthis.starttime.on({ set: $.bind( this.onSetStartTime, this ) });\n\t\t\tthis.enddate.on({ set: $.bind( this.onSetEndDate, this ) });\n\t\t\tthis.endtime.on({ set: $.bind( this.onSetEndTime, this ) });\n\n\t\t\treturn this;\n\t\t},\n\n\t\tshow: function() {\n\t\t\tthis.category && this.category.reset();\n\t\t\treturn BaseView.prototype.show.apply( this, arguments );\n\t\t},\n\n\t\ttoggleCheckbox: function( on ) {\n\t\t\tif ( !(this.$allday && this.$allday.length) )\n\t\t\t\treturn;\n\n\t\t\tvar chk = this.$allday.find('i');\n\t\t\tif ( !(chk && chk.length) )\n\t\t\t\treturn;\n\n\t\t\tvar checked = chk.hasClass('joms-icon-check');\n\t\t\tif ( checked === on )\n\t\t\t\treturn;\n\n\t\t\tthis.allday = on;\n\t\t\tchk[ this.allday ? 'removeClass' : 'addClass' ]('joms-icon-check-empty');\n\t\t\tchk[ this.allday ? 'addClass' : 'removeClass' ]('joms-icon-check');\n\t\t\tthis.$starttime[ this.allday ? 'hide' : 'show' ]();\n\t\t\tthis.$endtime[ this.allday ? 'hide' : 'show' ]();\n\t\t\tthis.allday || this._checkTime();\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\n\t\tvalue: function() {\n\t\t\treturn this.data;\n\t\t},\n\n\t\tvalidate: function() {\n\t\t},\n\n\t\treset: function() {\n\t\t\tthis.$location.val('');\n\t\t\tthis.$startdate.val('');\n\t\t\tthis.$starttime.val('');\n\t\t\tthis.$enddate.val('');\n\t\t\tthis.$endtime.val('');\n\t\t\tthis.toggleCheckbox( false );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\n\t\tonToggleCheckbox: function( e ) {\n\t\t\tvar elem = $( e.currentTarget ).find('i');\n\t\t\tthis.toggleCheckbox( !elem.hasClass('joms-icon-check') );\n\t\t},\n\n\t\tonSetStartDate: function( o ) {\n\t\t\tvar ts = o.select;\n\t\t\tthis.enddate.set({ min: new Date(ts) }, { muted: true });\n\t\t\tthis.allday || this._checkTime();\n\t\t},\n\n\t\tonSetEndDate: function( o ) {\n\t\t\tvar ts = o.select;\n\t\t\tthis.startdate.set({ max: new Date(ts) }, { muted: true });\n\t\t\tthis.allday || this._checkTime();\n\t\t},\n\n\t\tonSetStartTime: function() {\n\t\t\tthis._checkTime('start');\n\t\t},\n\n\t\tonSetEndTime: function() {\n\t\t\tthis._checkTime('end');\n\t\t},\n\n\t\tonSave: function() {\n\t\t\tvar category = this.category.value(),\n\t\t\t\tstartdate = this.startdate.get('select'),\n\t\t\t\tstarttime = null,\n\t\t\t\tenddate = this.enddate.get('select'),\n\t\t\t\tendtime = null,\n\t\t\t\terror;\n\n\t\t\tstartdate && (startdate = this._formatDate(startdate));\n\t\t\tenddate && (enddate = this._formatDate(enddate));\n\n\t\t\tif ( !this.allday ) {\n\t\t\t\tstarttime = this.starttime.get('select');\n\t\t\t\tstarttime && (starttime = this._formatTime(starttime));\n\t\t\t\tendtime = this.endtime.get('select');\n\t\t\t\tendtime && (endtime = this._formatTime(endtime));\n\t\t\t}\n\n\t\t\tthis.data = {\n\t\t\t\tcategory: category ? [ category, this.categoriesMap[ category ] ] : false,\n\t\t\t\tlocation: this.$location.val(),\n\t\t\t\tstartdate: startdate,\n\t\t\t\tenddate: enddate,\n\t\t\t\tallday: this.allday,\n\t\t\t\tstarttime: starttime,\n\t\t\t\tendtime: endtime\n\t\t\t};\n\n\t\t\tif ( !this.data.category ) {\n\t\t\t\terror = 'Category is not selected.';\n\t\t\t} else if ( !this.data.location ) {\n\t\t\t\terror = 'Location is not selected.';\n\t\t\t} else if ( !this.data.startdate ) {\n\t\t\t\terror = 'Start date is not selected.';\n\t\t\t} else if ( !this.data.allday && !this.data.starttime ) {\n\t\t\t\terror = 'Start time is not selected.';\n\t\t\t} else if ( !this.data.enddate ) {\n\t\t\t\terror = 'End date is not selected.';\n\t\t\t} else if ( !this.data.allday && !this.data.endtime ) {\n\t\t\t\terror = 'End time is not selected.';\n\t\t\t}\n\n\t\t\tif ( error ) {\n\t\t\t\twindow.alert( error );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.trigger( 'select', this.data );\n\t\t\tthis.hide();\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Helper functions.\n\t\t// ---------------------------------------------------------------------\n\n\t\tgetTemplate: function() {\n\t\t\tvar html = this.template({\n\t\t\t\tlanguage: {\n\t\t\t\t\tevent: language.get('event') || {}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn $( html ).hide();\n\t\t},\n\n\t\t_formatDate: function( date ) {\n\t\t\tif ( !date )\n\t\t\t\treturn date;\n\n\t\t\treturn [\n\t\t\t\tdate.year,\n\t\t\t\tformat.pad(date.month + 1 + '', 2, '0' ),\n\t\t\t\tformat.pad(date.date + '', 2, '0' )\n\t\t\t].join('-');\n\t\t},\n\n\t\t_formatTime: function( time ) {\n\t\t\tif ( !time )\n\t\t\t\treturn time;\n\n\t\t\treturn [\n\t\t\t\tformat.pad(time.hour + '', 2, '0'),\n\t\t\t\tformat.pad(time.mins + '', 2, '0')\n\t\t\t].join(':');\n\t\t},\n\n\t\t_checkTime: function() {\n\t\t\tif ( this.allday )\n\t\t\t\treturn;\n\n\t\t\tvar startdate = this.startdate.get('select'),\n\t\t\t\tenddate = this.enddate.get('select'),\n\t\t\t\tstarttime, endtime;\n\n\t\t\tif ( !startdate || !enddate )\n\t\t\t\treturn;\n\n\t\t\tif ( enddate.year <= startdate.year &&\n\t\t\t\t\tenddate.month <= startdate.month &&\n\t\t\t\t\tenddate.date <= startdate.date ) {\n\n\t\t\t\tstarttime = this.starttime.get('select');\n\t\t\t\tendtime = this.endtime.get('select');\n\n\t\t\t\tif ( !starttime )\n\t\t\t\t\tthis.endtime.set({ min: false }, { muted: true });\n\t\t\t\telse {\n\t\t\t\t\tthis.endtime.set({ min: [ starttime.hour, starttime.mins ] }, { muted: true });\n\t\t\t\t\tif ( endtime && endtime.time < starttime.time )\n\t\t\t\t\t\tthis.endtime.set({ select: [ starttime.hour, starttime.mins ] }, { muted: true });\n\t\t\t\t}\n\n\t\t\t\tif ( !endtime )\n\t\t\t\t\tthis.starttime.set({ max: false }, { muted: true });\n\t\t\t\telse {\n\t\t\t\t\tthis.starttime.set({ max: [ endtime.hour, endtime.mins ] }, { muted: true });\n\t\t\t\t\tif ( starttime && starttime.time > endtime.time )\n\t\t\t\t\t\tthis.starttime.set({ select: [ endtime.hour, endtime.mins ] }, { muted: true });\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tthis.starttime.set({ max: false }, { muted: true });\n\t\t\t\tthis.endtime.set({ min: false }, { muted: true });\n\t\t\t}\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/postbox/event\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/postbox/event',[\n\t'sandbox',\n\t'views/postbox/default',\n\t'views/inputbox/eventtitle',\n\t'views/inputbox/eventdesc',\n\t'views/dropdown/event',\n\t'utils/constants',\n\t'utils/format',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction(\n\t$,\n\tDefaultView,\n\tTitleView,\n\tInputboxView,\n\tEventView,\n\tconstants,\n\tformat,\n\tlanguage\n) {\n\n\treturn DefaultView.extend({\n\n\t\tsubviews: {\n\t\t\tevent: EventView\n\t\t},\n\n\t\ttemplate: joms.jst[ 'html/postbox/event' ],\n\n\t\tevents: $.extend({}, DefaultView.prototype.events, {\n\t\t\t'click .joms-postbox-event-title': 'onFocus'\n\t\t}),\n\n\t\trender: function() {\n\t\t\tDefaultView.prototype.render.apply( this );\n\n\t\t\tthis.$title = this.$('.joms-postbox-title');\n\t\t\tthis.$inputbox = this.$('.joms-postbox-inputbox');\n\t\t\tthis.$category = this.$('.joms-postbox-event-label-category');\n\t\t\tthis.$location = this.$('.joms-postbox-event-label-location');\n\t\t\tthis.$date = this.$('.joms-postbox-event-label-date');\n\n\t\t\t// title\n\t\t\tthis.title = new TitleView();\n\t\t\tthis.assign( this.$title, this.title );\n\t\t\tthis.listenTo( this.title, 'focus', this.onInputFocus );\n\t\t\tthis.listenTo( this.title, 'keydown', this.onNewInputUpdate );\n\n\t\t\t// inputbox\n\t\t\tthis.inputbox = new InputboxView({ charcount: true });\n\t\t\tthis.assign( this.$inputbox, this.inputbox );\n\t\t\tthis.listenTo( this.inputbox, 'focus', this.onInputFocus );\n\t\t\tthis.listenTo( this.inputbox, 'keydown', this.onNewInputUpdate );\n\n\t\t\treturn this;\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Data validation and retrieval.\n\t\t// ---------------------------------------------------------------------\n\n\t\treset: function() {\n\t\t\tDefaultView.prototype.reset.apply( this );\n\t\t\tthis.title && this.title.reset();\n\t\t\tthis.inputbox && this.inputbox.reset();\n\t\t\tthis.$category && this.onEventSelect({});\n\t\t},\n\n\t\tvalue: function() {\n\t\t\tthis.data.text = this.inputbox.value() || '';\n\t\t\tthis.data.attachment = {};\n\n\t\t\tvar value;\n\t\t\tfor ( var prop in this.subflags )\n\t\t\t\tif ( value = this.subviews[ prop ].value() )\n\t\t\t\t\tthis.data.attachment[ prop ] = value;\n\n\t\t\tvar starttime = null,\n\t\t\t\tendtime = null,\n\t\t\t\tallday = this._data.allday ? 1 : 0;\n\n\t\t\tif ( !allday ) {\n\t\t\t\tstarttime = (this._data.starttime || '').split(':');\n\t\t\t\tendtime = (this._data.endtime || '').split(':');\n\t\t\t}\n\n\t\t\t$.extend( this.data.attachment, {\n\t\t\t\ttitle: this.title.value(),\n\t\t\t\tcatid: this._data.category && this._data.category[0] || null,\n\t\t\t\tlocation: this._data.location,\n\t\t\t\tstartdate: this._data.startdate,\n\t\t\t\tenddate: this._data.enddate,\n\t\t\t\tallday: allday,\n\t\t\t\t'starttime-hour': allday ? null : (starttime[0] || null),\n\t\t\t\t'starttime-min': allday ? null : (starttime[1] || null),\n\t\t\t\t'endtime-hour': allday ? null : (endtime[0] || null),\n\t\t\t\t'endtime-min': allday ? null : (endtime[1] || null)\n\t\t\t});\n\n\t\t\treturn DefaultView.prototype.value.apply( this, arguments );\n\t\t},\n\n\t\tvalidate: function() {\n\t\t\tvar value = this.value( true ),\n\t\t\t\ttext = value[0];\n\n\t\t\tif ( !text )\n\t\t\t\treturn 'Event description cannot be empty.';\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Inputbox event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonInputFocus: function() {\n\t\t\tthis.showMainState();\n\t\t},\n\n\t\tonInputUpdate: $.debounce(function() {\n\t\t\tvar value = this.value( true ),\n\t\t\t\ttext = value[0],\n\t\t\t\tattachment = value[1],\n\t\t\t\tshow = true;\n\n\t\t\tif ( !this.trim( attachment.title ) )\n\t\t\t\tshow = false;\n\t\t\telse if ( !this.trim( text ) )\n\t\t\t\tshow = false;\n\t\t\telse if ( !attachment.catid )\n\t\t\t\tshow = false;\n\t\t\telse if ( !attachment.location )\n\t\t\t\tshow = false;\n\t\t\telse if ( !attachment.startdate )\n\t\t\t\tshow = false;\n\t\t\telse if ( !attachment.enddate )\n\t\t\t\tshow = false;\n\t\t\telse if ( !attachment.allday && !attachment['starttime-hour'] && !attachment['starttime-min'] )\n\t\t\t\tshow = false;\n\t\t\telse if ( !attachment.allday && !attachment['endtime-hour'] && !attachment['endtime-min'] )\n\t\t\t\tshow = false;\n\n\t\t\tthis.$save[ show ? 'show' : 'hide' ]();\n\n\t\t}, 300 ),\n\n\t\tonNewInputUpdate: $.debounce(function() {\n\t\t\tvar value = this.value( true ),\n\t\t\t\ttext = value[0],\n\t\t\t\tattachment = value[1],\n\t\t\t\tshow = true;\n\n\t\t\tif ( !this.trim( attachment.title ) )\n\t\t\t\tshow = false;\n\t\t\telse if ( !this.trim( text ) )\n\t\t\t\tshow = false;\n\t\t\telse if ( !attachment.catid )\n\t\t\t\tshow = false;\n\t\t\telse if ( !attachment.location )\n\t\t\t\tshow = false;\n\t\t\telse if ( !attachment.startdate )\n\t\t\t\tshow = false;\n\t\t\telse if ( !attachment.enddate )\n\t\t\t\tshow = false;\n\t\t\telse if ( !attachment.allday && !attachment['starttime-hour'] && !attachment['starttime-min'] )\n\t\t\t\tshow = false;\n\t\t\telse if ( !attachment.allday && !attachment['endtime-hour'] && !attachment['endtime-min'] )\n\t\t\t\tshow = false;\n\n\t\t\tthis.$save[ show ? 'show' : 'hide' ]();\n\n\t\t}, 300 ),\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Dropdowns event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonEventSelect: function( data ) {\n\t\t\tif ( !data.category ) {\n\t\t\t\tthis.$category.hide();\n\t\t\t} else {\n\t\t\t\tthis.$category.find('.joms-input-text').html( data.category && data.category[1] );\n\t\t\t\tthis.$category.show();\n\t\t\t}\n\n\t\t\tif ( !data.location ) {\n\t\t\t\tthis.$location.hide();\n\t\t\t} else {\n\t\t\t\tthis.$location.find('.joms-input-text').html( data.location );\n\t\t\t\tthis.$location.show();\n\t\t\t}\n\n\t\t\tvar date, str = [];\n\t\t\tif ( !data.startdate || !data.enddate ) {\n\t\t\t\tthis.$date.hide();\n\t\t\t} else {\n\t\t\t\tdate = data.startdate.split('-');\n\t\t\t\tdate.reverse();\n\t\t\t\tdate = date.join('/');\n\t\t\t\tif ( !data.allday ) {\n\t\t\t\t\tdate += ' ' + data.starttime;\n\t\t\t\t}\n\t\t\t\tstr.push( date );\n\n\t\t\t\tdate = data.enddate.split('-');\n\t\t\t\tdate.reverse();\n\t\t\t\tdate = date.join('/');\n\t\t\t\tif ( !data.allday ) {\n\t\t\t\t\tdate += ' ' + data.endtime;\n\t\t\t\t}\n\t\t\t\tstr.push( date );\n\n\t\t\t\tthis.$date.find('.joms-input-text').html( str.join(' &mdash; ') );\n\t\t\t\tthis.$date.show();\n\t\t\t}\n\n\t\t\tthis._data = data;\n\t\t\tthis.onInputUpdate();\n\t\t},\n\n\t\tonPrivacySelect: function( data ) {\n\t\t\tthis.$tabprivacy.find('i').attr( 'class', 'joms-icon-' + data.icon );\n\t\t\tthis.$tabprivacy.find('span').html( data.label );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Ajax response parser.\n\t\t// ---------------------------------------------------------------------\n\n\t\tparseResponse: function( response ) {\n\t\t\tvar elid = 'activity-stream-container',\n\t\t\t\tdata, temp;\n\n\t\t\tif ( response && response.length ) {\n\t\t\t\tfor ( var i = 0; i < response.length; i++ )\t{\n\t\t\t\t\tif ( response[i][1] === elid ) {\n\t\t\t\t\t\tdata = response[i][3];\n\t\t\t\t\t}\n\t\t\t\t\tif ( response[i][0] === 'al' ) {\n\t\t\t\t\t\ttemp = response[i][3];\n\t\t\t\t\t\twindow.alert( $.isArray( temp ) ? temp.join('. ') : temp );\n\t\t\t\t\t}\n\t\t\t\t\tif ( response[i][1] === '__throwError' ) {\n\t\t\t\t\t\ttemp = response[i][3];\n\t\t\t\t\t\twindow.alert( $.isArray( temp ) ? temp.join('. ') : temp );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn data;\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Helper functions.\n\t\t// ---------------------------------------------------------------------\n\n\t\tgetTemplate: function() {\n\t\t\tvar lang = language.get('event') || {};\n\t\t\tif ( lang.event_detail )\n\t\t\t\tlang.event_detail = lang.event_detail.toLowerCase();\n\n\t\t\tvar html = this.template({\n\t\t\t\tjuri: constants.get('juri'),\n\t\t\t\tlanguage: {\n\t\t\t\t\tpostbox: language.get('postbox') || {},\n\t\t\t\t\tevent: lang\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn $( html ).hide();\n\t\t},\n\n\t\tgetStaticAttachment: function() {\n\t\t\tif ( this.staticAttachment )\n\t\t\t\treturn this.staticAttachment;\n\n\t\t\tthis.staticAttachment = $.extend({},\n\t\t\t\tconstants.get('postbox.attachment') || {},\n\t\t\t\t{ type: 'event' }\n\t\t\t);\n\n\t\t\treturn this.staticAttachment;\n\t\t},\n\n\t\ttrim: function( text ) {\n\t\t\treturn (text || '').replace( /^\\s+|\\s+$/g, '' );\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/postbox/custom\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/postbox/custom',[\n\t'sandbox',\n\t'views/postbox/default',\n\t'views/dropdown/privacy',\n\t'utils/ajax',\n\t'utils/constants',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction(\n\t$,\n\tDefaultView,\n\tPrivacyView,\n\tajax,\n\tconstants,\n\tlanguage\n) {\n\n\treturn DefaultView.extend({\n\n\t\tsubviews: {\n\t\t\tprivacy: PrivacyView\n\t\t},\n\n\t\ttemplate: joms.jst[ 'html/postbox/custom' ],\n\n\t\tevents: $.extend({}, DefaultView.prototype.events, {\n\t\t\t'click .joms-postbox-predefined-message': 'onCustomPredefined',\n\t\t\t'click .joms-postbox-custom-message': 'onCustomCustom',\n\t\t\t'keyup [name=custom]': 'onTextareaUpdate'\n\t\t}),\n\n\t\tinitialize: function() {\n\t\t\tvar settings = constants.get('settings') || {};\n\t\t\tif ( this.inheritPrivacy = (settings.isGroup || settings.isEvent || !settings.isMyProfile))\n\t\t\t\tthis.subviews = $.omit( this.subviews, 'privacy' );\n\n\t\t\tDefaultView.prototype.initialize.apply( this );\n\t\t\tthis.attachment = { type: 'custom' };\n\t\t\t$.extend( this.attachment, constants.get('postbox.attachment') || {} );\n\t\t},\n\n\t\trender: function() {\n\t\t\tDefaultView.prototype.render.apply( this );\n\n\t\t\tthis.$initial = this.$el.children('.joms-postbox-inner-panel');\n\t\t\tthis.$main = this.$el.children('.joms-postbox-custom');\n\t\t\tthis.$statepredefined = this.$('.joms-postbox-custom-state-predefined');\n\t\t\tthis.$statecustom = this.$('.joms-postbox-custom-state-custom');\n\n\t\t\tthis.$predefined = this.$('[name=predefined]');\n\t\t\tthis.$custom = this.$('[name=custom]');\n\t\t\tthis.$divs = this.$('.joms-postbox-dropdown').hide();\n\t\t\tthis.$tabprivacy = this.$tabs.find('[data-tab=privacy]');\n\n\t\t\tif ( this.inheritPrivacy )\n\t\t\t\tthis.$tabprivacy.css({ visibility: 'hidden' });\n\n\t\t\t// init privacy\n\t\t\tif ( !this.inheritPrivacy ) {\n\t\t\t\tthis.initSubview('privacy', { privacylist: [ 'public', 'site_members' ] });\n\t\t\t\tthis.subviews.privacy.setPrivacy('public');\n\t\t\t}\n\n\t\t\treturn this;\n\t\t},\n\n\t\tshowInitialState: function() {\n\t\t\tthis.$main.hide();\n\t\t\tthis.$initial.show();\n\t\t\tDefaultView.prototype.showInitialState.apply( this );\n\t\t},\n\n\t\tshowMainState: function( predefined ) {\n\t\t\tDefaultView.prototype.showMainState.apply( this );\n\t\t\tpredefined ? this.showPredefinedState() : this.showCustomState();\n\t\t},\n\n\t\tshowPredefinedState: function() {\n\t\t\tthis.$initial.hide();\n\t\t\tthis.$statepredefined.show();\n\t\t\tthis.$statecustom.hide();\n\t\t\tthis.$main.show();\n\t\t\tthis.$save.show();\n\t\t\tthis.predefined = true;\n\t\t},\n\n\t\tshowCustomState: function() {\n\t\t\tthis.$initial.hide();\n\t\t\tthis.$statepredefined.hide();\n\t\t\tthis.$statecustom.show();\n\t\t\tthis.$main.show();\n\t\t\tthis.predefined = false;\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Data validation and retrieval.\n\t\t// ---------------------------------------------------------------------\n\n\t\treset: function() {\n\t\t\tDefaultView.prototype.reset.apply( this );\n\t\t\tthis.$predefined && this.$predefined.val( this.$predefined.find('option:first').val() );\n\t\t\tthis.$custom && this.$custom.val('');\n\t\t},\n\n\t\tvalue: function() {\n\t\t\tvar data = [];\n\t\t\tif ( this.predefined ) {\n\t\t\t\tdata.push( this.$predefined.val() );\n\t\t\t\tdata.push( this.$predefined.find('option:selected').text() );\n\t\t\t} else {\n\t\t\t\tdata.push( 'system.message' );\n\t\t\t\tdata.push( this.$custom.val() );\n\t\t\t}\n\n\t\t\treturn data;\n\t\t},\n\n\t\tvalidate: function() {\n\t\t\tvar value = this.value(),\n\t\t\t\terror;\n\n\t\t\tif ( this.predefined ) {\n\t\t\t\tvalue[0] || (error = 'Predefined message cannot be empty.');\n\t\t\t} else  {\n\t\t\t\tvalue[1] || (error = 'Custom message cannot be empty.');\n\t\t\t}\n\n\t\t\treturn error;\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Textare event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonTextareaUpdate: function() {\n\t\t\tvar value = this.$custom.val();\n\t\t\tvalue = value.replace( /^\\s+|\\s+$/g, '' );\n\t\t\tthis.$save[ value ? 'show' : 'hide' ]();\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Panel event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonCustomPredefined: function() {\n\t\t\tthis.showMainState('predefined');\n\t\t},\n\n\t\tonCustomCustom: function() {\n\t\t\tthis.showMainState();\n\t\t},\n\n\t\tonPost: function() {\n\t\t\tif ( this.saving )\n\t\t\t\treturn;\n\n\t\t\tvar error = this.validate();\n\t\t\tif ( error ) {\n\t\t\t\twindow.alert( error );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.saving = true;\n\t\t\tthis.$loading.show();\n\n\t\t\tvar that = this;\n\t\t\tajax({\n\t\t\t\tfn: 'activities,ajaxAddPredefined',\n\t\t\t\tdata: this.value(),\n\t\t\t\tsuccess: $.bind( this.onPostSuccess, this ),\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tthat.$loading.hide();\n\t\t\t\t\tthat.saving = false;\n\t\t\t\t\tthat.showInitialState();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Dropdowns event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonPrivacySelect: function( data ) {\n\t\t\tthis.$tabprivacy.find('i').attr( 'class', 'joms-icon-' + data.icon );\n\t\t\tthis.$tabprivacy.find('span').html( data.label );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Helper functions.\n\t\t// ---------------------------------------------------------------------\n\n\t\tgetTemplate: function() {\n\t\t\tvar obj = constants.get('customActivities') || {},\n\t\t\t\tmessages = [];\n\n\t\t\tfor ( var prop in obj )\n\t\t\t\tmessages.push([ prop, obj[ prop ] ]);\n\n\t\t\tvar html = this.template({\n\t\t\t\tjuri: constants.get('juri'),\n\t\t\t\tmessages: messages,\n\t\t\t\tlanguage: {\n\t\t\t\t\tpostbox: language.get('postbox'),\n\t\t\t\t\tcustom: language.get('custom')\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn $( html ).hide();\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/postbox/layout\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/postbox/layout',[\n\t'sandbox',\n\t'views/base',\n\t'views/postbox/status',\n\t'views/postbox/photo',\n\t'views/postbox/video',\n\t'views/postbox/event',\n\t'views/postbox/custom',\n\t'utils/constants'\n],\n\n// definition\n// ----------\nfunction(\n\t$,\n\tBaseView,\n\tStatusView,\n\tPhotoView,\n\tVideoView,\n\tEventView,\n\tCustomView,\n\tconstants\n) {\n\n\treturn BaseView.extend({\n\n\t\tsubflags: {},\n\n\t\tsubviews: {\n\t\t\tstatus: StatusView,\n\t\t\tphoto: PhotoView,\n\t\t\tvideo: VideoView,\n\t\t\tevent: EventView,\n\t\t\tcustom: CustomView\n\t\t},\n\n\t\tevents: {\n\t\t\t'click .joms-postbox-tab-root li': 'onChangeTab'\n\t\t},\n\n\t\tinitialize: function() {\n\t\t\tthis.listenTo( $, 'postbox:photo', this.onOpenPhotoTab );\n\t\t\tthis.listenTo( $, 'postbox:video', this.onOpenVideoTab );\n\t\t},\n\n\t\trender: function() {\n\t\t\tvar settings = constants.get('settings') || {},\n\t\t\t\tconf = constants.get('conf') || {};\n\n\t\t\tif ( !settings.isAdmin || !conf.enablecustoms )\n\t\t\t\tthis.subviews = $.omit( this.subviews, 'custom' );\n\n\t\t\tif ( settings.isProfile && !settings.isMyProfile )\n\t\t\t\tthis.subviews = $.pick( this.subviews, 'status' );\n\n\t\t\tif ( settings.isEvent )\n\t\t\t\tthis.subviews = $.omit( this.subviews, 'photo', 'video', 'event' );\n\n\t\t\tif ( settings.isProfile || settings.isGroup ) {\n\t\t\t\tconf.enablephotos || (this.subviews = $.omit( this.subviews, 'photo' ));\n\t\t\t\tconf.enablevideos || (this.subviews = $.omit( this.subviews, 'video' ));\n\t\t\t\tconf.enableevents || (this.subviews = $.omit( this.subviews, 'event' ));\n\t\t\t}\n\n\t\t\t// cache subview keys\n\t\t\tthis.subkeys = $.keys( this.subviews );\n\n\t\t\t// cache elements\n\t\t\tthis.$subviews = this.$('.joms-postbox-tabs');\n\t\t\tthis.$tab = this.$('.joms-postbox-tab-root').hide();\n\n\t\t\t// remove unused tab\n\t\t\tvar that = this;\n\t\t\tthis.$tab.find('li').each(function() {\n\t\t\t\tvar elem = $( this ),\n\t\t\t\t\tkey = elem.data('tab');\n\n\t\t\t\tif ( that.subkeys.indexOf( key ) < 0 )\n\t\t\t\t\telem.remove();\n\t\t\t});\n\n\t\t\tif ( this.subkeys && this.subkeys.length )\n\t\t\t\tthis.changeTab( this.subkeys[0] );\n\t\t},\n\n\t\tshow: function() {\n\t\t\tthis.$el[ $.isMobile ? 'show' : 'fadeIn' ]();\n\t\t},\n\n\t\tchangeTab: function( type ) {\n\t\t\tif ( !this.subviews[ type ] )\n\t\t\t\treturn;\n\n\t\t\tvar elem = this.$tab.find( 'li[data-tab=' + type + ']' );\n\t\t\tif ( elem && elem.length ) {\n\t\t\t\telem.hasClass('active') || elem.addClass('active');\n\t\t\t\telem.siblings('.active').removeClass('active');\n\t\t\t}\n\n\t\t\tif ( !this.subflags[ type ] )\n\t\t\t\tthis.initSubview( type );\n\n\t\t\tfor ( var prop in this.subflags )\n\t\t\t\tif ( prop !== type )\n\t\t\t\t\tthis.subviews[ prop ].hide();\n\n\t\t\tthis.subviews[ type ].show();\n\t\t\t$.trigger( 'postbox:tab:change', type );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Event handlers.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonChangeTab: function( e ) {\n\t\t\tthis.changeTab( $( e.currentTarget ).data('tab') );\n\t\t},\n\n\t\tonOpenPhotoTab: function() {\n\t\t\tthis.changeTab('photo');\n\t\t},\n\n\t\tonOpenVideoTab: function() {\n\t\t\tthis.changeTab('video');\n\t\t},\n\n\t\tonShowInitialState: function() {\n\t\t\tif ( this.subkeys.length > 1 )\n\t\t\t\tthis.$tab.show();\n\t\t},\n\n\t\tonShowMainState: function() {\n\t\t\tthis.$tab.hide();\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Lazy subview initialization.\n\t\t// ---------------------------------------------------------------------\n\n\t\tinitSubview: function( type ) {\n\t\t\tif ( !this.subflags[ type ] ) {\n\t\t\t\tthis.subviews[ type ] = new this.subviews[ type ]({ single: this.subkeys.length <= 1 });\n\t\t\t\tthis.assign( this.getSubviewElement(), this.subviews[ type ] );\n\t\t\t\tthis.listenTo( this.subviews[ type ], 'show:initial', this.onShowInitialState );\n\t\t\t\tthis.listenTo( this.subviews[ type ], 'show:main', this.onShowMainState );\n\t\t\t\tthis.subflags[ type ] = true;\n\t\t\t}\n\t\t},\n\n\t\tgetSubviewElement: function() {\n\t\t\tvar div = $('<div>').hide().appendTo( this.$subviews );\n\t\t\treturn div;\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/stream/filterbar\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/stream/filterbar',[\n\t'sandbox',\n\t'views/base'\n],\n\n// definition\n// ----------\nfunction(\n\t$,\n\tBaseView\n) {\n\n\treturn BaseView.extend({\n\n\t\trender: function() {\n\t\t\tthis.$btn = $('.joms-activity-filter-action');\n\t\t\tthis.$list = $('.joms-activity-filter-dropdown');\n\t\t\tthis.$chk = this.$list.find('.joms-icon-checkbox-unchecked').closest('li');\n\t\t\tthis.$label = $('.joms-activity-filter-status');\n\n\t\t\tthis.$btn.on( 'click', $.bind( this.toggle, this ) );\n\t\t\tthis.$list.on( 'click', 'li', $.bind( this.select, this ) );\n\t\t\tthis.listenTo( $, 'click', this.onDocumentClick );\n\t\t},\n\n\t\ttoggle: function() {\n\t\t\tvar collapsed = this.$list[0].style.display === 'none';\n\t\t\tcollapsed ? this.expand() : this.collapse();\n\t\t},\n\n\t\texpand: function() {\n\t\t\tthis.$list.show();\n\t\t},\n\n\t\tcollapse: function() {\n\t\t\tthis.$list.hide();\n\t\t},\n\n\t\tselect: function( e ) {\n\t\t\tvar url = '',\n\t\t\t\tli = $( e.currentTarget ),\n\t\t\t\tdata = li.data(),\n\t\t\t\tchk = li.find('i'),\n\t\t\t\tchecked;\n\n\t\t\tif ( chk.length ) {\n\t\t\t\tchecked = !!chk.hasClass('joms-icon-checkbox-checked');\n\t\t\t}\n\n\t\t\tvar params = [];\n\t\t\tfor ( var prop in data ) {\n\t\t\t\tparams.push( prop + '=' + data[prop] );\n\t\t\t}\n\n\t\t\tparams = params.join('&');\n\t\t\turl += params ? '?' + params : '';\n\n\t\t\tthis.toggle();\n\t\t\twindow.location = url;\n\t\t},\n\n\t\tonDocumentClick: function( elem ) {\n\t\t\tif ( elem.closest('.joms-activity-filter').length )\n\t\t\t\treturn;\n\n\t\t\tthis.collapse();\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/stream/item\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/stream/item',[\n\t'sandbox',\n\t'views/base',\n\t'utils/constants',\n\t'utils/language'\n],\n\n// definition\n// ----------\nfunction( $, BaseView, constants, language ) {\n\n\treturn BaseView.extend({\n\n\t\tel: '#activity-stream-container',\n\n\t\tevents: {\n\t\t\t'click .dropdown-menu a[data-action=edit]': 'onEditStream',\n\t\t\t'click .dropdown-menu a[data-action=remove-tag]': 'onRemoveStreamTag',\n\t\t\t'click [data-type=stream-editor] [data-action=cancel]': 'onEditStreamCancel',\n\t\t\t'click [data-type=stream-editor] [data-action=save]': 'onEditStreamSave',\n\t\t\t'click [data-type=stream-action] [data-action=comment]': 'onCommentStreamAdd',\n\t\t\t'click [data-type=stream-comments] [data-action=reply]': 'onCommentStreamAdd',\n\t\t\t'click [data-type=stream-newcomment] [data-action=cancel]': 'onCommentStreamAddCancel',\n\t\t\t'click [data-type=stream-newcomment] [data-action=save]': 'onCommentStreamAddSave',\n\t\t\t'click [data-type=stream-comment] [data-action=edit]': 'onCommentStreamEdit',\n\t\t\t'click [data-type=stream-comment] [data-action=cancel]': 'onCommentStreamEditCancel',\n\t\t\t'click [data-type=stream-comment] [data-action=save]': 'onCommentStreamEditSave',\n\t\t\t'click [data-type=stream-comment] [data-action=remove]': 'onCommentStreamRemove',\n\t\t\t'click [data-type=stream-comment] [data-action=remove-tag]': 'onCommentStreamRemoveTag'\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Edit stream events.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonEditStream: function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tvar el = $( e.target ),\n\t\t\t\tct = this.getContainer( el ),\n\t\t\t\tcontent = ct.children('[data-type=stream-content]'),\n\t\t\t\teditor = ct.children('[data-type=stream-editor]');\n\n\t\t\tif ( editor.is(':visible') )\n\t\t\t\treturn;\n\n\t\t\tcontent.hide();\n\t\t\teditor.show();\n\t\t\tthis.resetStreamEditor( editor );\n\t\t\tthis.focusTextarea( editor );\n\t\t},\n\n\t\tonEditStreamCancel: function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tvar ct = this.getContainer( e.target ),\n\t\t\t\tcontent = ct.children('[data-type=stream-content]'),\n\t\t\t\teditor = ct.children('[data-type=stream-editor]');\n\n\t\t\tif ( !editor.is(':visible') )\n\t\t\t\treturn;\n\n\t\t\teditor.hide();\n\t\t\tcontent.show();\n\t\t},\n\n\t\tonEditStreamSave: function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tvar ct = this.getContainer( e.target ),\n\t\t\t\teditor = ct.children('[data-type=stream-editor]'),\n\t\t\t\tthat = this,\n\t\t\t\ttextarea;\n\n\t\t\tif ( !editor.is(':visible') )\n\t\t\t\treturn;\n\n\t\t\ttextarea = editor.find('textarea');\n\t\t\ttextarea.textntags( 'val', function( value ) {\n\t\t\t\tjoms.stream.ajaxSaveStatus( that.getStreamId( ct ), value );\n\t\t\t\teditor.hide();\n\t\t\t});\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Add stream comment events.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonCommentStreamAdd: function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tvar ct = this.getContainer( e.target ),\n\t\t\t\teditor = ct.find('[data-type=stream-newcomment]');\n\n\t\t\tif ( editor.is(':visible') )\n\t\t\t\treturn;\n\n\t\t\teditor.show();\n\t\t\tthis.resetStreamEditor( editor, true );\n\t\t\tthis.focusTextarea( editor );\n\t\t\tthis.hideAddCommentButton( ct );\n\t\t},\n\n\t\tonCommentStreamAddCancel: function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tvar ct = this.getContainer( e.target ),\n\t\t\t\teditor = ct.find('[data-type=stream-newcomment]');\n\n\t\t\tif ( !editor.is(':visible') )\n\t\t\t\treturn;\n\n\t\t\tif ( editor.data('saving') )\n\t\t\t\treturn;\n\n\t\t\teditor.hide();\n\t\t\tthis.showAddCommentButton( ct );\n\t\t},\n\n\t\tonCommentStreamAddSave: function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tvar el = $( e.target ),\n\t\t\t\tct = this.getContainer( e.target ),\n\t\t\t\teditor = ct.find('[data-type=stream-newcomment]'),\n\t\t\t\tthat = this,\n\t\t\t\ttextarea;\n\n\t\t\tif ( !editor.is(':visible') )\n\t\t\t\treturn;\n\n\t\t\tif ( editor.data('saving') )\n\t\t\t\treturn;\n\n\t\t\teditor.data( 'saving', 1 );\n\t\t\tel.data( 'label', el.text() );\n\t\t\tel.html( 'Saving...' );\n\t\t\tel.prop('disabled',true);\n\n\t\t\ttextarea = editor.find('textarea');\n\t\t\ttextarea.textntags( 'val', function( value ) {\n\t\t\t\tjax.doneLoadingFunction = function() {\n\t\t\t\t\tjax.doneLoadingFunction = $.noop;\n\t\t\t\t\teditor.removeData( 'saving' );\n\t\t\t\t\tel.html( el.data('label') );\n\t\t\t\t\tel.prop('disabled',false);\n\t\t\t\t};\n\t\t\t\tjax.call( 'community', 'system,ajaxStreamAddComment', that.getStreamId( ct ), value );\n\t\t\t});\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Edit stream comment events.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonCommentStreamEdit: function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tvar el = $( e.target ),\n\t\t\t\tct = this.getContainer( e.target ),\n\t\t\t\tcontent = el.closest('[data-type=stream-comment-content]'),\n\t\t\t\teditor = content.siblings('[data-type=stream-comment-editor]'),\n\t\t\t\tnewCommentEditor = ct.find('[data-type=stream-newcomment]');\n\n\t\t\tif ( editor.is(':visible') )\n\t\t\t\treturn;\n\n\t\t\tnewCommentEditor.hide();\n\t\t\tcontent.hide();\n\t\t\teditor.show();\n\t\t\tthis.resetStreamEditor( editor, true );\n\t\t\tthis.focusTextarea( editor );\n\t\t\tthis.hideAddCommentButton( ct );\n\t\t},\n\n\t\tonCommentStreamEditCancel: function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tvar el = $( e.target ),\n\t\t\t\tct = this.getContainer( e.target ),\n\t\t\t\teditor = el.closest('[data-type=stream-comment-editor]'),\n\t\t\t\tcontent = editor.siblings('[data-type=stream-comment-content]');\n\n\t\t\tif ( !editor.is(':visible') )\n\t\t\t\treturn;\n\n\t\t\tif ( editor.data('saving') )\n\t\t\t\treturn;\n\n\t\t\teditor.hide();\n\t\t\tcontent.show();\n\t\t\tthis.showAddCommentButton( ct );\n\t\t},\n\n\t\tonCommentStreamEditSave: function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tvar el = $( e.target ),\n\t\t\t\tct = this.getContainer( e.target ),\n\t\t\t\teditor = el.closest('[data-type=stream-comment-editor]'),\n\t\t\t\tcontent = editor.siblings('[data-type=stream-comment-content]'),\n\t\t\t\tthat = this,\n\t\t\t\ttextarea;\n\n\t\t\tif ( !editor.is(':visible') )\n\t\t\t\treturn;\n\n\t\t\tif ( editor.data('saving') )\n\t\t\t\treturn;\n\n\t\t\teditor.data( 'saving', 1 );\n\t\t\tel.data( 'label', el.text() );\n\t\t\tel.html( 'Saving...' );\n\n\t\t\ttextarea = editor.find('textarea');\n\t\t\ttextarea.textntags( 'val', function( value ) {\n\t\t\t\tvar id = editor.closest('[data-type=stream-comment]').data('commentid');\n\t\t\t\tjax.doneLoadingFunction = function() {\n\t\t\t\t\tjax.doneLoadingFunction = $.noop;\n\t\t\t\t\teditor.removeData( 'saving' );\n\t\t\t\t\tel.html( el.data('label') );\n\t\t\t\t};\n\t\t\t\tjax.call( 'community', 'system,ajaxeditComment', id, value, that.getStreamId( ct ) );\n\t\t\t});\n\n\t\t\teditor.hide();\n\t\t\tcontent.show();\n\t\t\tthis.showAddCommentButton( ct );\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Remove stream comment events.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonCommentStreamRemove: function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tvar that = this,\n\t\t\t\tactions;\n\n\t\t\tactions = $([\n\t\t\t\t'<div><button class=\"btn\" onclick=\"cWindowHide();\">', language.get('no'),\n\t\t\t\t'</button><button class=\"btn btn-primary pull-right\">', language.get('yes'),\n\t\t\t\t'</button></div>'\n\t\t\t].join(''));\n\n\t\t\tactions.on( 'click', '.btn-primary', function() {\n\t\t\t\tthat.onCommentStreamRemoveConfirm( e );\n\t\t\t\twindow.cWindowHide();\n\t\t\t});\n\n\t\t\twindow.cWindowShow( null, language.get('stream.remove_comment'), 450, 100 );\n\t\t\twindow.cWindowAddContent( '<div>' + language.get('stream.remove_comment_message') + '</div>', actions );\n\t\t},\n\n\t\tonCommentStreamRemoveConfirm: function( e ) {\n\t\t\tvar ct = this.getContainer( e.target ),\n\t\t\t\tthat = this;\n\n\t\t\tjax.loadingFunction = $.noop;\n\t\t\tjax.doneLoadingFunction = function() {\n\t\t\t\tjax.doneLoadingFunction = $.noop;\n\n\t\t\t\tvar more = ct.find('[data-type=stream-more]'),\n\t\t\t\t\tcounter = more.find('.wall-cmt-count'),\n\t\t\t\t\tn;\n\n\t\t\t\tif ( more && more.length ) {\n\t\t\t\t\tn = +counter.text();\n\t\t\t\t\tif ( n > 1 )\n\t\t\t\t\t\tcounter.text( n - 1 );\n\t\t\t\t\telse\n\t\t\t\t\t\tmore.remove();\n\t\t\t\t}\n\n\t\t\t\tthat.showAddCommentButton( ct );\n\t\t\t};\n\n\t\t\tjax.call(\n\t\t\t\t'community',\n\t\t\t\t'system,ajaxStreamRemoveComment',\n\t\t\t\t$( e.target ).data('id')\n\t\t\t);\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Remove tag.\n\t\t// ---------------------------------------------------------------------\n\n\t\tonRemoveStreamTag: function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tvar el = $( e.target ),\n\t\t\t\tct = this.getContainer( el ),\n\t\t\t\teditor = ct.children('[data-type=stream-editor]'),\n\t\t\t\ttextarea = editor.find('textarea'),\n\t\t\t\ttext = textarea.data('original') || textarea.val(),\n\t\t\t\tuid = constants.get('uid'),\n\t\t\t\ttag;\n\n\t\t\tif ( !uid )\n\t\t\t\treturn;\n\n\t\t\ttag = this.getTagFromUid( text, uid );\n\t\t\tif ( !tag )\n\t\t\t\treturn;\n\n\t\t\tjax.call(\n\t\t\t\t'community',\n\t\t\t\t'activities,ajaxRemoveUserTag',\n\t\t\t\tthis.getStreamId( ct ),\n\t\t\t\ttag,\n\t\t\t\t'post'\n\t\t\t);\n\t\t},\n\n\t\tonCommentStreamRemoveTag: function( e ) {\n\t\t\te.preventDefault();\n\n\t\t\tvar el = $( e.target ),\n\t\t\t\tcontent = el.closest('[data-type=stream-comment-content]'),\n\t\t\t\teditor = content.siblings('[data-type=stream-comment-editor]'),\n\t\t\t\ttextarea = editor.find('textarea'),\n\t\t\t\ttext = textarea.data('original') || textarea.val(),\n\t\t\t\tuid = constants.get('uid'),\n\t\t\t\ttag;\n\n\t\t\tif ( !uid )\n\t\t\t\treturn;\n\n\t\t\ttag = this.getTagFromUid( text, uid );\n\t\t\tif ( !tag )\n\t\t\t\treturn;\n\n\t\t\tjax.call(\n\t\t\t\t'community',\n\t\t\t\t'activities,ajaxRemoveUserTag',\n\t\t\t\teditor.closest('[data-type=stream-comment]').data('commentid'),\n\t\t\t\ttag,\n\t\t\t\t'comment'\n\t\t\t);\n\t\t},\n\n\t\t// ---------------------------------------------------------------------\n\t\t// Helper functions.\n\t\t// ---------------------------------------------------------------------\n\n\t\tgetStreamId: function( el ) {\n\t\t\treturn $( el )\n\t\t\t\t.closest('li[data-streamid]')\n\t\t\t\t.data('streamid');\n\t\t},\n\n\t\tgetContainer: function( el ) {\n\t\t\treturn $( el )\n\t\t\t\t.closest('li[data-streamid]')\n\t\t\t\t.children('.joms-stream-content');\n\t\t},\n\n\t\tgetTagFromUid: function( text, uid ) {\n\t\t\tif ( !text || !uid )\n\t\t\t\treturn false;\n\n\t\t\tvar re = new RegExp( '@\\\\[\\\\[' + uid + ':contact:[^\\\\]]+\\\\]\\\\]' ),\n\t\t\t\tmatches = text.match( re );\n\n\t\t\treturn matches && matches[0];\n\t\t},\n\n\t\tfocusTextarea: function( editor ) {\n\t\t\tvar textarea, length;\n\t\t\ttextarea = editor.find('textarea').focus();\n\t\t\ttextarea = textarea[0];\n\t\t\tif ( textarea && textarea.setSelectionRange ) {\n\t\t\t\tlength = textarea.value.length;\n\t\t\t\ttextarea.setSelectionRange( length, length );\n\t\t\t}\n\t\t},\n\n\t\thideAddCommentButton: function( ct ) {\n\t\t\tvar comment = ct.find('[data-type=stream-action] [data-action=comment]'),\n\t\t\t\treply = ct.find('[data-type=stream-reply]');\n\n\t\t\tcomment.hide();\n\t\t\treply.hide();\n\t\t},\n\n\t\tshowAddCommentButton: function( ct ) {\n\t\t\tvar comment = ct.find('[data-type=stream-action] [data-action=comment]'),\n\t\t\t\treply = ct.find('[data-type=stream-reply]'),\n\t\t\t\tcounter = reply.siblings('[data-type=stream-comment]').length,\n\t\t\t\tmore = reply.siblings('[data-type=stream-more]').length;\n\n\t\t\tcomment[ counter || more ? 'hide' : 'show' ]();\n\t\t\treply[ counter || more ? 'show' : 'hide' ]();\n\t\t},\n\n\t\tresetStreamEditor: function( el, isComment ) {\n\t\t\tvar textarea = $( el ).find('textarea'),\n\t\t\t\tinitialized = textarea.data('initialized');\n\n\t\t\tif ( !initialized ) {\n\t\t\t\ttextarea.data( 'original', textarea.val() );\n\t\t\t\ttextarea.data( 'initialized', 1 );\n\t\t\t\tthis.initTextntags( textarea, isComment );\n\t\t\t}\n\n\t\t\ttextarea.textntags( 'val', textarea.data('original') );\n\t\t},\n\n\t\tinitTextntags: function( textarea, isComment ) {\n\t\t\tvar that = this;\n\t\t\ttextarea.textntags({\n\t\t\t\ttriggers: { '@': {\n\t\t\t\t\tuniqueTags: true,\n\t\t\t\t\tminChars: 1\n\t\t\t\t} },\n\t\t\t\tonDataRequest: function( mode, query, triggerChar, callback ) {\n\t\t\t\t\tvar url = 'index.php?option=com_community&view=friends&task=ajaxAutocomplete&streamid=' + that.getStreamId( textarea ),\n\t\t\t\t\t\tsettings = constants.get('settings');\n\n\t\t\t\t\tif ( settings.isGroup )\n\t\t\t\t\t\turl += '&groupid=' + constants.get('groupid');\n\t\t\t\t\telse if ( settings.isEvent )\n\t\t\t\t\t\turl += '&eventid=' + constants.get('eventid');\n\n\t\t\t\t\tif ( that.fetchTextntags )\n\t\t\t\t\t\tthat.fetchTextntags.abort();\n\n\t\t\t\t\tthat.fetchTextntags = $.ajax({\n\t\t\t\t\t\turl: url + '&query=' + query + ( isComment ? '&type=comment' : '' ),\n\t\t\t\t\t\tdataType: 'json',\n\t\t\t\t\t\tsuccess: function( json ) {\n\t\t\t\t\t\t\tvar data = [],\n\t\t\t\t\t\t\t\ti;\n\n\t\t\t\t\t\t\tif ( json && json.suggestions && json.suggestions.length ) {\n\t\t\t\t\t\t\t\tfor ( i = 0; i < json.suggestions.length; i++ )\n\t\t\t\t\t\t\t\t\tdata.push({\n\t\t\t\t\t\t\t\t\t\tid: json.data[i],\n\t\t\t\t\t\t\t\t\t\tname: json.suggestions[i],\n\t\t\t\t\t\t\t\t\t\tavatar: json.img[i].replace( /^.+src=\"([^\"]+)\".+$/ , '$1'),\n\t\t\t\t\t\t\t\t\t\ttype: 'contact'\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\tquery = query.toLowerCase();\n\t\t\t\t\t\t\t\tdata = $.filter( data, function( item ) { return item.name.toLowerCase().indexOf( query ) > -1; });\n\t\t\t\t\t\t\t\tcallback.call( this, data );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: function() {\n\t\t\t\t\t\t\tthat.fetchTextntags = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/stream/layout\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/stream/layout',[\n\t'sandbox',\n\t'views/base',\n\t'views/stream/filterbar',\n\t'views/stream/item'\n],\n\n// definition\n// ----------\nfunction(\n\t$,\n\tBaseView,\n\tFilterbarView,\n\tItemView\n) {\n\n\treturn BaseView.extend({\n\n\t\tinitialize: function() {\n\t\t\tthis.filterbar = new FilterbarView();\n\t\t\tthis.item = new ItemView();\n\t\t},\n\n\t\trender: function() {\n\t\t\tthis.filterbar.render();\n\t\t\tthis.item.render();\n\n\t\t\t$( document ).on( 'click', '.dropdown-menu li a', function() {\n\t\t\t\tvar el = $( this ),\n\t\t\t\t\tct = el.closest('.joms-privacy-dropdown'),\n\t\t\t\t\ticon = ct.find('.dropdown-toggle').find('i'),\n\t\t\t\t\tspan = ct.prev('.joms-share-privacy');\n\n\t\t\t\tif ( icon && icon.length )\n\t\t\t\t\ticon.attr( 'class', el.find('i').attr('class') );\n\n\t\t\t\tif ( span && span.length )\n\t\t\t\t\tspan.html( el.find('span').html() );\n\t\t\t});\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// views/layout/layout\n// -----------------------------------------------------------------------------\n\n// dependencies\n// ------------\ndefine('views/header/layout',[\n\t'sandbox',\n\t'views/base'\n],\n\n// definition\n// ----------\nfunction( $, BaseView ) {\n\n\treturn BaseView.extend({\n\n\t\trender: function() {\n\t\t\tthis.onResize();\n\t\t\t$( window ).on( 'resize', this.onResize );\n\t\t},\n\n\t\tonResize: function() {\n\t\t\tvar cover = $('.js-focus-cover'),\n\t\t\t\timg = cover.children('img'),\n\t\t\t\tposition = img.position() || {},\n\t\t\t\theight, ratio;\n\n\t\t\tif ( !position.top )\n\t\t\t\treturn;\n\n\t\t\theight = img.height();\n\t\t\tratio = img.data('ratio');\n\n\t\t\tif ( !ratio ) {\n\t\t\t\tratio = Math.abs( position.top ) / height;\n\t\t\t\timg.data('ratio', ratio );\n\t\t\t}\n\n\t\t\timg.css({ top: 0 - ratio * height });\n\t\t}\n\n\t});\n\n});\n","\n// -----------------------------------------------------------------------------\n// application initialization\n// -----------------------------------------------------------------------------\n\n// requirements\n// ------------\nrequire([\n   'sandbox',\n   'views/postbox/layout',\n   'views/stream/layout',\n   'views/header/layout'\n],\n\n// description\n// -----------\nfunction( $, PostboxView, StreamView, HeaderView ) {\n\n\tfunction initPostbox() {\n\t\tvar el = $('.joms-postbox'),\n\t\t\tpostbox;\n\n\t\tif ( el.length ) {\n\t\t\tpostbox = new PostboxView({ el: el });\n\t\t\tpostbox.render();\n\t\t\tpostbox.show();\n\t\t}\n\t}\n\n\tfunction initStream() {\n\t\tvar stream = new StreamView();\n\t\tstream.render();\n\t}\n\n\tfunction initHeader() {\n\t\tvar header = new HeaderView();\n\t\theader.render();\n\t}\n\n\t$(function() {\n\t\tinitPostbox();\n\t\tinitStream();\n\t\tinitHeader();\n\n\t});\n\n});\n\ndefine(\"init\", function(){});\n","\n// -----------------------------------------------------------------------------\n// requirejs configuration\n// -----------------------------------------------------------------------------\n\nrequire.config({\n\turlArgs: 'bust=' + (new Date()).getTime(),\n\tdeps: [ 'init' ]\n});\n\ndefine(\"bundle\", function(){});\n"]}